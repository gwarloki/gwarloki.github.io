{"title":"å¼€æºWAFè°ƒç ”ä¹‹äº§å“é€‰å‹-Nginxä¸´æ—¶åº”æ€¥å·¥å…·","uid":"ca8ec5f39f069a5397c4e6f4f192ade4","slug":"Nginx-log-checkæ£€æµ‹å·¥å…·","date":"2022-06-15T14:30:16.000Z","updated":"2022-10-26T10:01:41.029Z","comments":true,"path":"api/articles/Nginx-log-checkæ£€æµ‹å·¥å…·.json","keywords":null,"cover":"https://gtwallpaper.org/sites/default/files/wallpaper/159445/a-tunnel-8k-secret-passage-wallpapers-159445-3841-2646948.png","content":"<h2 id=\"å·¥å…·ä»‹ç»\"><a href=\"#å·¥å…·ä»‹ç»\" class=\"headerlink\" title=\"å·¥å…·ä»‹ç»\"></a>å·¥å…·ä»‹ç»</h2><p>æ­¤è„šæœ¬æ˜¯å‚è€ƒnmgxy&#x2F;klionsecä¿®æ”¹è€Œæ¥,é‡æ–°æ·»åŠ äº†ä¸€äº›ç‰¹å¾ï¼Œåªç”¨æ¥ä¸´æ—¶æ•‘æ€¥ï¼Œè¿˜æ˜¯æ¨èåˆ°ELKæˆ–è€…Splunkä¸­åˆ†æ<br>ğŸ©é¡¹ç›®åœ°å€<a href=\"https://github.com/al0ne/nginx_log_check\">GitHub - al0ne&#x2F;nginx_log_check: Nginxæ—¥å¿—å®‰å…¨åˆ†æè„šæœ¬</a></p>\n<h2 id=\"åŠŸèƒ½\"><a href=\"#åŠŸèƒ½\" class=\"headerlink\" title=\"åŠŸèƒ½\"></a>åŠŸèƒ½</h2><ul>\n<li>ç»Ÿè®¡Top 20 åœ°å€</li>\n<li>SQLæ³¨å…¥åˆ†æ</li>\n<li>SQLæ³¨å…¥ FROMæŸ¥è¯¢ç»Ÿè®¡</li>\n<li>æ‰«æå™¨&#x2F;å¸¸ç”¨é»‘å®¢å·¥å…·</li>\n<li>æ¼æ´åˆ©ç”¨æ£€æµ‹</li>\n<li>æ•æ„Ÿè·¯å¾„è®¿é—®</li>\n<li>æ–‡ä»¶åŒ…å«æ”»å‡»</li>\n<li>HTTP Tunnel</li>\n<li>Webshell</li>\n<li>å¯»æ‰¾å“åº”é•¿åº¦çš„url Top 20</li>\n<li>å¯»æ‰¾ç½•è§çš„è„šæœ¬æ–‡ä»¶è®¿é—®</li>\n<li>å¯»æ‰¾302è·³è½¬çš„è„šæœ¬æ–‡ä»¶</li>\n</ul>\n<h2 id=\"è„šæœ¬\"><a href=\"#è„šæœ¬\" class=\"headerlink\" title=\"è„šæœ¬\"></a>è„šæœ¬</h2><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">#!&#x2F;usr&#x2F;bin&#x2F;env bash\n\necho &quot;&quot;\necho &quot; &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; &quot;\necho &quot; \\                 Nginxæ—¥å¿—å®‰å…¨åˆ†æè„šæœ¬ V1.0            &#x2F; &quot;\necho &quot; &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; &quot;\necho &quot; # æ”¯æŒNginxæ—¥å¿—åˆ†æï¼Œæ”»å‡»å‘Šè­¦åˆ†æç­‰                    &quot;\necho &quot; # authorï¼šal0ne                    &quot;\necho &quot; # https:&#x2F;&#x2F;github.com&#x2F;al0ne                    &quot;\necho -e &quot;\\n&quot;\n\n#å¦‚æœå­˜åœ¨å¤šä¸ªaccessæ–‡ä»¶æˆ–è€…æœ‰å¤šä¸ªaccess.x.gz å»ºè®®å…ˆzcat access*.gz &gt;&gt;access.logæ–‡ä»¶ä¸­\n#è®¾ç½®åˆ†æç»“æœå­˜å‚¨ç›®å½•,ç»“å°¾ä¸èƒ½åŠ &#x2F;\noutfile&#x3D;&#x2F;tmp&#x2F;logs\n#å¦‚æœç›®å½•ä»¥å­˜åœ¨åˆ™æ¸…ç©ºï¼Œæœªå­˜åœ¨åˆ™æ–°å»ºç›®å½•\nif [ -d $outfile ]; then\n    rm -rf $outfile&#x2F;*\nelse\n    mkdir -p $outfile\nfi\n#è®¾ç½®nginxæ—¥å¿—ç›®å½•ï¼Œç»“å°¾å¿…é¡»åŠ &#x2F;\naccess_dir&#x3D;&#x2F;var&#x2F;log&#x2F;nginx&#x2F;\n#è®¾ç½®æ–‡ä»¶åï¼Œå¦‚æœæ–‡ä»¶åä¸ºaccessé‚£ä¹ˆåŒ¹é…çš„æ˜¯access*æ–‡ä»¶\naccess_log&#x3D;access\n#åˆ¤æ–­æ—¥å¿—æ–‡ä»¶æ˜¯å¦å­˜åœ¨\nnum&#x3D;$(ls $&#123;access_dir&#125;$&#123;access_log&#125;* | wc -l) &gt;&#x2F;dev&#x2F;null 2&gt;&amp;1\nif [ $num -eq 0 ]; then\n    echo &#39;æ—¥å¿—æ–‡ä»¶ä¸å­˜åœ¨&#39;\n    exit 1\nfi\necho -e &quot;\\n&quot;\n\n# éªŒè¯æ“ä½œç³»ç»Ÿæ˜¯debianç³»è¿˜æ˜¯centos\nOS&#x3D;&#39;None&#39;\nif [ -e &quot;&#x2F;etc&#x2F;os-release&quot; ]; then\n    source &#x2F;etc&#x2F;os-release\n    case $&#123;ID&#125; in\n    &quot;debian&quot; | &quot;ubuntu&quot; | &quot;devuan&quot;)\n        OS&#x3D;&#39;Debian&#39;\n        ;;\n    &quot;centos&quot; | &quot;rhel fedora&quot; | &quot;rhel&quot;)\n        OS&#x3D;&#39;Centos&#39;\n        ;;\n    *) ;;\n    esac\nfi\n\nif [ $OS &#x3D; &#39;None&#39; ]; then\n    if command -v apt-get &gt;&#x2F;dev&#x2F;null 2&gt;&amp;1; then\n        OS&#x3D;&#39;Debian&#39;\n    elif command -v yum &gt;&#x2F;dev&#x2F;null 2&gt;&amp;1; then\n        OS&#x3D;&#39;Centos&#39;\n    else\n        echo -e &quot;\\nä¸æ”¯æŒè¿™ä¸ªç³»ç»Ÿ\\n&quot;\n        echo -e &quot;å·²é€€å‡º&quot;\n        exit 1\n    fi\nfi\n\n# æ£€æµ‹agè½¯ä»¶æœ‰æ²¡æœ‰å®‰è£…\nif ag -V &gt;&#x2F;dev&#x2F;null 2&gt;&amp;1; then\n    echo -e &quot;\\e[00;32msilversearcher-agå·²å®‰è£… \\e[00m&quot;\nelse\n    if [ $OS &#x3D; &#39;Centos&#39; ]; then\n        yum -y install the_silver_searcher &gt;&#x2F;dev&#x2F;null 2&gt;&amp;1\n    else\n        apt-get -y install silversearcher-ag &gt;&#x2F;dev&#x2F;null 2&gt;&amp;1\n    fi\n\nfi\n#å¦‚æœæ£€æµ‹åˆ«çš„æ—¥å¿—è¯·æ‰‹åŠ¨æ›¿æ¢åç§»ï¼Œä¾‹å¦‚awkçš„$7ä»£è¡¨urlï¼Œ$9ä»£è¡¨çŠ¶æ€ç ï¼Œ$10ä»£è¡¨é•¿åº¦,æœ¬è„šæœ¬æ˜¯ä»¥nginxæ—¥å¿—ä¸ºåŸºç¡€\n\necho &quot;åˆ†æç»“æœæ—¥å¿—ï¼š$&#123;outfile&#125;&quot;\necho &quot;Nginxæ—¥å¿—ç›®å½•ï¼š$&#123;access_dir&#125;&quot;\necho &quot;Nginxæ–‡ä»¶åï¼š$&#123;access_log&#125;&quot;\necho -e &quot;\\n&quot;\n\necho -e &quot;\\e[00;31m[+]TOP 20 IP åœ°å€\\e[00m&quot;\nag -a -o --nofilename &#39;\\d+\\.\\d+\\.\\d+\\.\\d+&#39; $&#123;access_dir&#125;$&#123;access_log&#125;* | sort | uniq -c | sort -nr | head -n 20 | tee -a $&#123;outfile&#125;&#x2F;top20.log\necho -e &quot;\\n&quot;\n\necho -e &quot;\\e[00;31m[+]SQLæ³¨å…¥æ”»å‡»åˆ†æ\\e[00m&quot;\n#åœ¨SQLæ³¨å…¥ä¸­æ’é™¤æ‰äº†ä¸€äº›æ‰«æcss&#x2F;js&#x2F;pngå›¾ç‰‡ç±»ç­‰æ— ç”¨å‘Šè­¦ï¼Œå¹¶ä¸”é‡ç‚¹ç­›é€‰çŠ¶æ€ç 200æˆ–è€…500çš„å‘Šè­¦\nag -a &quot;xp_cmdshell|%20xor|%20and|%20AND|%20or|%20OR|select%20|%20and%201&#x3D;1|%20and%201&#x3D;2|%20from|%27exec|information_schema.tables|load_file|benchmark|substring|table_name|table_schema|%20where%20|%20union%20|%20UNION%20|concat\\(|concat_ws\\(|%20group%20|0x5f|0x7e|0x7c|0x27|%20limit|\\bcurrent_user\\b|%20LIMIT|version%28|version\\(|database%28|database\\(|user%28|user\\(|%20extractvalue|%updatexml|rand\\(0\\)\\*2|%20group%20by%20x|%20NULL%2C|sqlmap&quot; $&#123;access_dir&#125;$&#123;access_log&#125;* | ag -v &#39;&#x2F;\\w+\\.(?:js|css|html|jpg|jpeg|png|htm|swf)(?:\\?| )&#39; | awk &#39;($9&#x3D;&#x3D;200)||($9&#x3D;&#x3D;500) &#123;print $0&#125;&#39; &gt;$&#123;outfile&#125;&#x2F;sql.log\nawk &#39;&#123;print &quot;SQLæ³¨å…¥æ”»å‡»&quot; NR&quot;æ¬¡&quot;&#125;&#39; $&#123;outfile&#125;&#x2F;sql.log | tail -n1\necho &quot;SQLæ³¨å…¥ TOP 20 IPåœ°å€&quot;\nag -o &#39;(?&lt;&#x3D;:)\\d+\\.\\d+\\.\\d+\\.\\d+&#39; $&#123;outfile&#125;&#x2F;sql.log | sort | uniq -c | sort -nr | head -n 20 | tee -a $&#123;outfile&#125;&#x2F;sql_top20.log\n# é‡ç‚¹å…³æ³¨fromæŸ¥è¯¢ï¼Œæ˜¯å¦å­˜åœ¨è„±è£¤è¡Œä¸ºï¼Œæ’é™¤æ‰«æè¡Œä¸º\necho &quot;SQLæ³¨å…¥ FROM æŸ¥è¯¢&quot;\ncat $&#123;outfile&#125;&#x2F;sql.log | ag &#39;\\bfrom\\b&#39; | ag -v &#39;information_schema&#39; &gt;$&#123;outfile&#125;&#x2F;sql_from_query.log\nawk &#39;&#123;print &quot;SQLæ³¨å…¥FROMæŸ¥è¯¢&quot; NR&quot;æ¬¡&quot;&#125;&#39; $&#123;outfile&#125;&#x2F;sql_from_query.log | tail -n1\necho -e &quot;\\n&quot;\n\necho -e &quot;\\e[00;31m[+]æ‰«æå™¨scan &amp; é»‘å®¢å·¥å…·\\e[00m&quot;\nag -a &quot;acunetix|by_wvs|nikto|netsparker|HP404|nsfocus|WebCruiser|owasp|nmap|nessus|HEAD &#x2F;|AppScan|burpsuite|w3af|ZAP|openVAS|.+avij|.+angolin|360webscan|webscan|XSS@HERE|XSS%40HERE|NOSEC.JSky|wwwscan|wscan|antSword|WebVulnScan|WebInspect|ltx71|masscan|python-requests|Python-urllib|WinHttpRequest&quot; $&#123;access_dir&#125;$&#123;access_log&#125;* | ag -v &#39;&#x2F;\\w+\\.(?:js|css|jpg|jpeg|png|swf)(?:\\?| )&#39; | awk &#39;($9&#x3D;&#x3D;200)||($9&#x3D;&#x3D;500) &#123;print $0&#125;&#39; &gt;$&#123;outfile&#125;&#x2F;scan.log\nawk &#39;&#123;print &quot;å…±æ£€æµ‹åˆ°æ‰«ææ”»å‡»&quot; NR&quot;æ¬¡&quot;&#125;&#39; $&#123;outfile&#125;&#x2F;scan.log | tail -n1\necho &quot;æ‰«æå·¥å…·æµé‡ TOP 20&quot;\nag -o &#39;(?&lt;&#x3D;:)\\d+\\.\\d+\\.\\d+\\.\\d+&#39; $&#123;outfile&#125;&#x2F;scan.log | sort | uniq -c | sort -nr | head -n 20 | tee -a $&#123;outfile&#125;&#x2F;scan_top20.log\necho -e &quot;\\n&quot;\n\necho -e &quot;\\e[00;31m[+]æ•æ„Ÿè·¯å¾„è®¿é—®\\e[00m&quot;\nag -a &quot;&#x2F;_cat&#x2F;|&#x2F;_config&#x2F;|include&#x3D;|phpinfo|info\\.php|&#x2F;web-console|JMXInvokerServlet|&#x2F;manager&#x2F;html|axis2-admin|axis2-web|phpMyAdmin|phpmyadmin|&#x2F;admin-console|&#x2F;jmx-console|&#x2F;console&#x2F;|\\.tar.gz|\\.tar|\\.tar.xz|\\.xz|\\.zip|\\.rar|\\.mdb|\\.inc|\\.sql|&#x2F;\\.config\\b|\\.bak|&#x2F;.svn&#x2F;|&#x2F;\\.git&#x2F;|\\.hg|\\.DS_Store|\\.htaccess|nginx\\.conf|\\.bash_history|&#x2F;CVS&#x2F;|\\.bak|wwwroot|å¤‡ä»½|&#x2F;Web.config|&#x2F;web.config|&#x2F;1.txt|&#x2F;test.txt&quot; $&#123;access_dir&#125;$&#123;access_log&#125;* | awk &#39;($9&#x3D;&#x3D;200)||($9&#x3D;&#x3D;500) &#123;print $0&#125;&#39; &gt;$&#123;outfile&#125;&#x2F;dir.log\nawk &#39;&#123;print &quot;å…±æ£€æµ‹åˆ°é’ˆå¯¹æ•æ„Ÿæ–‡ä»¶æ‰«æ&quot; NR&quot;æ¬¡&quot;&#125;&#39; $&#123;outfile&#125;&#x2F;dir.log | tail -n1\necho &quot;æ•æ„Ÿæ–‡ä»¶è®¿é—®æµé‡ TOP 20&quot;\nag -o &#39;(?&lt;&#x3D;:)\\d+\\.\\d+\\.\\d+\\.\\d+&#39; $&#123;outfile&#125;&#x2F;dir.log | sort | uniq -c | sort -nr | head -n 20 | tee -a $&#123;outfile&#125;&#x2F;dir_top20.log\necho -e &quot;\\n&quot;\n\necho -e &quot;\\e[00;31m[+]æ¼æ´åˆ©ç”¨æ£€æµ‹\\e[00m&quot;\nag -a &quot;%00|&#x2F;win.ini|&#x2F;my.ini|\\.\\.&#x2F;\\.\\.&#x2F;|&#x2F;etc&#x2F;shadow|%0D%0A|file:&#x2F;|gopher:&#x2F;|dict:&#x2F;|WindowsPowerShell|&#x2F;wls-wsat&#x2F;|call_user_func_array|uddiexplorer|@DEFAULT_MEMBER_ACCESS|@java\\.lang\\.Runtime|OgnlContext|&#x2F;bin&#x2F;bash|cmd\\.exe|wget\\s|curl\\s|s&#x3D;&#x2F;index&#x2F;\\think&quot; $&#123;access_dir&#125;$&#123;access_log&#125;* | awk &#39;($9&#x3D;&#x3D;200)||($9&#x3D;&#x3D;500) &#123;print $0&#125;&#39; &gt;$&#123;outfile&#125;&#x2F;exploit.log\nawk &#39;&#123;print &quot;æ¼æ´åˆ©ç”¨æ¢æµ‹&quot; NR&quot;æ¬¡&quot;&#125;&#39; $&#123;outfile&#125;&#x2F;exploit.log | tail -n1\necho &quot;æ¼æ´åˆ©ç”¨æ£€æµ‹ TOP 20&quot;\nag -o &#39;(?&lt;&#x3D;:)\\d+\\.\\d+\\.\\d+\\.\\d+&#39; $&#123;outfile&#125;&#x2F;exploit.log | sort | uniq -c | sort -nr | head -n 20 | tee -a $&#123;outfile&#125;&#x2F;exploit_top20.log\necho -e &quot;\\n&quot;\n\necho -e &quot;\\e[00;31m[+]webshell\\e[00m&quot;\nag -a &quot;&#x3D;whoami|dbname&#x3D;|exec&#x3D;|cmd&#x3D;|\\br57\\b|\\bc99\\b|\\bc100\\b|\\bb374k\\b|adminer.php|eval\\(|assert\\(|%eval|%execute|tunnel\\.[asp|php|jsp|aspx]&#123;3,4&#125;|makewebtaski|ma\\.[asp|php|jsp|aspx]&#123;3,4&#125;|\\bup\\.[asp|php|jsp|aspx]&#123;3,4&#125;|cmd\\.[asp|php|jsp|aspx]&#123;3,4&#125;|201\\d\\.[asp|php|jsp|aspx]&#123;3,4&#125;|xiaoma\\.[asp|php|jsp|aspx]&#123;3,4&#125;|shell\\.[asp|php|jsp|aspx]&#123;3,4&#125;|404\\.[asp|php|jsp|aspx]&#123;3,4&#125;|tom\\.[asp|php|jsp|aspx]&#123;3,4&#125;|k8cmd\\.[asp|php|jsp|aspx]&#123;3,4&#125;|ver[0-9]&#123;3,4&#125;\\.[asp|php|jsp|aspx]&#123;3,4&#125;|\\.aar|[asp|php|jsp|aspx]&#123;3,4&#125;spy\\.|o&#x3D;vLogin|aioshell|admine|ghost\\.[asp|php|jsp|aspx]&#123;3,4&#125;|r00ts|90sec|t00ls|editor\\.aspx|wso\\.[asp|aspx]&#123;3,4&#125;&quot; $&#123;access_dir&#125;$&#123;access_log&#125;* | awk &#39;($9&#x3D;&#x3D;200)||($9&#x3D;&#x3D;500) &#123;print $0&#125;&#39; &gt;$&#123;outfile&#125;&#x2F;webshell.log\nawk &#39;&#123;print &quot;å…±æ£€æµ‹åˆ°webshellè¡Œä¸º&quot; NR &quot;æ¬¡&quot;&#125;&#39; $&#123;outfile&#125;&#x2F;webshell.log | tail -n1\necho &quot;Webshell TOP 20&quot;\nag -o &#39;(?&lt;&#x3D;:)\\d+\\.\\d+\\.\\d+\\.\\d+&#39; $&#123;outfile&#125;&#x2F;webshell.log | sort | uniq -c | sort -nr | head -n 20 | tee -a $&#123;outfile&#125;&#x2F;webshell_top20.log\necho -e &quot;\\n&quot;\n\necho -e &quot;\\e[00;31m[+]HTTP Tunnel\\e[00m&quot;\n#Regeorgä»£ç†ç‰¹å¾\nag -a &quot;cmd&#x3D;disconnect|cmd&#x3D;read|cmd&#x3D;forward|cmd&#x3D;connect|127.0.0.1&quot; $&#123;access_dir&#125;$&#123;access_log&#125;* | awk &#39;($9&#x3D;&#x3D;200)||($9&#x3D;&#x3D;500) &#123;print $0&#125;&#39; | tee -a $&#123;outfile&#125;&#x2F;tunnel.log\nawk &#39;&#123;print &quot;å…±æ£€æµ‹åˆ°éš§é“è¡Œä¸º&quot; NR &quot;æ¬¡&quot;&#125;&#39; $&#123;outfile&#125;&#x2F;tunnel.log | tail -n1\necho -e &quot;\\n&quot;\n\necho -e &quot;\\e[00;31m[+]Top 20 urlå“åº”é•¿åº¦\\e[00m&quot;\n# æŸ¥æ‰¾urlå“åº”é•¿åº¦æœ€é•¿çš„urlæ’åºï¼Œç›®çš„æ˜¯æœ‰æ²¡æœ‰ä¸‹è½½æœåŠ¡å™¨çš„ä¸€äº›æ‰“åŒ…æ–‡ä»¶\nlen&#x3D;$(cat $&#123;access_dir&#125;$&#123;access_log&#125;* | awk &#39;&#123;print $10&#125;&#39; | sort -nr | head -n 20)\necho $len | awk &#39;BEGIN&#123; RS&#x3D;&quot; &quot; &#125;&#123; print $0 &#125;&#39; | xargs -i&#123;&#125; ag -a --nocolor &#39;\\d+\\s&#123;&#125;\\s&#39; $&#123;access_dir&#125;$&#123;access_log&#125;* | awk &#39;&#123;print $7,$10&#125;&#39; | sort | uniq | sort -k 2 -nr | tee -a $&#123;outfile&#125;&#x2F;url_rsp_len.log\necho -e &quot;\\n&quot;\n\necho -e &quot;\\e[00;31m[+]ç½•è§çš„è„šæœ¬æ–‡ä»¶è®¿é—®\\e[00m&quot;\necho &quot;è®¿é—®é‡ç‰¹åˆ«ç‰¹åˆ«å°‘çš„è„šæœ¬æ–‡ä»¶ææœ‰å¯èƒ½æ˜¯webshell&quot;\ncat $&#123;access_dir&#125;$&#123;access_log&#125;* | awk &#39;($9&#x3D;&#x3D;200)||($9&#x3D;&#x3D;500) &#123;print $7&#125;&#39; | sort | uniq -c | sort -n | ag -v &#39;\\?&#39; | ag &#39;\\.php|\\.jsp|\\.asp|\\.aspx&#39; | head -n 20 | tee -a $&#123;outfile&#125;&#x2F;rare_url.log\necho -e &quot;\\n&quot;\n\necho -e &quot;\\e[00;31m[+]302è·³è½¬\\e[00m&quot;\necho &quot;æ­¤ç›®çš„æ˜¯å¯»æ‰¾ä¸€äº›ç™»å½•æˆåŠŸçš„è„šæœ¬æ–‡ä»¶&quot;\ncat $&#123;access_dir&#125;$&#123;access_log&#125;* | awk &#39;($9&#x3D;&#x3D;302)||($9&#x3D;&#x3D;301) &#123;print $7&#125;&#39; | sort | uniq -c | sort -n | ag -v &#39;\\?&#39; | ag &#39;\\.php|\\.jsp|\\.asp|\\.aspx&#39; | head -n 20 | tee -a $&#123;outfile&#125;&#x2F;302_goto.log\necho -e &quot;\\n&quot;\n</code></pre>","text":"å·¥å…·ä»‹ç»æ­¤è„šæœ¬æ˜¯å‚è€ƒnmgxy&#x2F;klionsecä¿®æ”¹è€Œæ¥,é‡æ–°æ·»åŠ äº†ä¸€äº›ç‰¹å¾ï¼Œåªç”¨æ¥ä¸´æ—¶æ•‘æ€¥ï¼Œè¿˜æ˜¯æ¨èåˆ°ELKæˆ–è€…Splunkä¸­åˆ†æğŸ©é¡¹ç›®åœ°å€GitHub - al0ne&#x2F;nginx_log_check: Nginxæ—¥å¿—å®‰å…¨åˆ†æè„šæœ¬ åŠŸèƒ½ ç»Ÿè®¡Top 20 åœ°...","link":"","photos":[],"count_time":{"symbolsCount":"11k","symbolsTime":"10 mins."},"categories":[{"name":"å¼€æºWAFäº§å“é€‰å‹","slug":"å¼€æºWAFäº§å“é€‰å‹","count":7,"path":"api/categories/å¼€æºWAFäº§å“é€‰å‹.json"}],"tags":[{"name":"åº”æ€¥å“åº”","slug":"åº”æ€¥å“åº”","count":1,"path":"api/tags/åº”æ€¥å“åº”.json"},{"name":"Nginx","slug":"Nginx","count":7,"path":"api/tags/Nginx.json"},{"name":"å¼€æºWAFäº§å“é€‰å‹","slug":"å¼€æºWAFäº§å“é€‰å‹","count":7,"path":"api/tags/å¼€æºWAFäº§å“é€‰å‹.json"},{"name":"æ—¥å¿—åˆ†æ","slug":"æ—¥å¿—åˆ†æ","count":1,"path":"api/tags/æ—¥å¿—åˆ†æ.json"},{"name":"å®‰å…¨å»ºè®¾","slug":"å®‰å…¨å»ºè®¾","count":7,"path":"api/tags/å®‰å…¨å»ºè®¾.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D\"><span class=\"toc-text\">å·¥å…·ä»‹ç»</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%8A%9F%E8%83%BD\"><span class=\"toc-text\">åŠŸèƒ½</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E8%84%9A%E6%9C%AC\"><span class=\"toc-text\">è„šæœ¬</span></a></li></ol>","author":{"name":"Moses","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"ä¸€ä½æ­£åœ¨é‡å¡‘çŸ¥è¯†çš„æŠ€æœ¯äºº","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"SCAè½¯ä»¶æˆåˆ†åˆ†æå‰æœŸæ¢ç´¢","uid":"e996202d66a481abb2ff37739071b61f","slug":"SCAè½¯ä»¶æˆåˆ†åˆ†æå‰æœŸæ¢ç´¢","date":"2022-06-17T04:52:00.000Z","updated":"2022-10-26T08:05:03.210Z","comments":true,"path":"api/articles/SCAè½¯ä»¶æˆåˆ†åˆ†æå‰æœŸæ¢ç´¢.json","keywords":null,"cover":"https://gtwallpaper.org/sites/default/files/wallpaper/159447/abstract-ink-wallpapers-159447-4046-3049997.png","text":"SCAè½¯ä»¶æˆåˆ†åˆ†æå‰æœŸæ¢ç´¢æ¦‚è¿°å’ŒèƒŒæ™¯SCAæ¦‚å¿µSCA(Software Composition Analysis)è½¯ä»¶æˆåˆ†åˆ†ææŠ€æœ¯ä¸»è¦å°±æ˜¯é’ˆå¯¹å¼€æºè½¯ä»¶ä»¥åŠç¬¬ä¸‰æ–¹å•†ä¸šè½¯ä»¶è®¾è®¡çš„å„ç§æºç ã€æºç åº“ã€æ¨¡å—å’Œæ¡†æ¶ï¼Œè¯†åˆ«å’Œæ¸…ç‚¹å¼€æºè½¯ä»¶çš„ç»„ä»¶åŠå…¶æ„æˆå’Œä¾èµ–å…³ç³»ï¼Œå¹¶è¯†åˆ«å·²çŸ¥çš„å®‰å…¨æ¼æ´æˆ–æ½œåœ¨çš„è®¸å¯...","link":"","photos":[],"count_time":{"symbolsCount":"12k","symbolsTime":"11 mins."},"categories":[{"name":"è½¯ä»¶ä¾›åº”é“¾å®‰å…¨","slug":"è½¯ä»¶ä¾›åº”é“¾å®‰å…¨","count":26,"path":"api/categories/è½¯ä»¶ä¾›åº”é“¾å®‰å…¨.json"}],"tags":[{"name":"SCA","slug":"SCA","count":15,"path":"api/tags/SCA.json"},{"name":"è½¯ä»¶ä¾›åº”é“¾å®‰å…¨","slug":"è½¯ä»¶ä¾›åº”é“¾å®‰å…¨","count":11,"path":"api/tags/è½¯ä»¶ä¾›åº”é“¾å®‰å…¨.json"},{"name":"SBOM","slug":"SBOM","count":5,"path":"api/tags/SBOM.json"},{"name":"å¼€æºæ¼æ´åº“","slug":"å¼€æºæ¼æ´åº“","count":2,"path":"api/tags/å¼€æºæ¼æ´åº“.json"},{"name":"å®‰å…¨","slug":"å®‰å…¨","count":1,"path":"api/tags/å®‰å…¨.json"}],"author":{"name":"Moses","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"ä¸€ä½æ­£åœ¨é‡å¡‘çŸ¥è¯†çš„æŠ€æœ¯äºº","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"å¼€æºWAFè°ƒç ”ä¹‹äº§å“é€‰å‹-Nginx+ModSecurity3.0","uid":"35772fd534664d45a9bf135dc04685bc","slug":"å¼€æºWAFé€‰å‹-Nginx+ModSecurity3.0","date":"2022-06-09T06:39:16.000Z","updated":"2022-10-26T10:10:07.278Z","comments":true,"path":"api/articles/å¼€æºWAFé€‰å‹-Nginx+ModSecurity3.0.json","keywords":null,"cover":"https://gtwallpaper.org/sites/default/files/wallpaper/159446/abrams-falls-wallpapers-159446-1969-4235097.png","text":"äº§å“ä¿¡æ¯ç®€ä»‹ åç§° å¼€æºåè®® å¼€å‘è¯­è¨€ å¼€æºæ—¶é—´ æ´»è·ƒåº¦ ä»£ç è´¨é‡ æœ€æ–°ç‰ˆæœ¬ å‚å•† ModSecurity BSD 3-Clause License Lua 2013-12-16ï¼ˆ2.7.6ï¼‰ 5.4Kâ­ï¸ A 2022-05-31 ï¼ˆ3.1.7ï¼‰ Trustwave ModSec...","link":"","photos":[],"count_time":{"symbolsCount":"8.7k","symbolsTime":"8 mins."},"categories":[{"name":"å¼€æºWAFäº§å“é€‰å‹","slug":"å¼€æºWAFäº§å“é€‰å‹","count":7,"path":"api/categories/å¼€æºWAFäº§å“é€‰å‹.json"}],"tags":[{"name":"Nginx","slug":"Nginx","count":7,"path":"api/tags/Nginx.json"},{"name":"å¼€æºWAFäº§å“é€‰å‹","slug":"å¼€æºWAFäº§å“é€‰å‹","count":7,"path":"api/tags/å¼€æºWAFäº§å“é€‰å‹.json"},{"name":"å®‰å…¨å»ºè®¾","slug":"å®‰å…¨å»ºè®¾","count":7,"path":"api/tags/å®‰å…¨å»ºè®¾.json"},{"name":"WAF","slug":"WAF","count":6,"path":"api/tags/WAF.json"},{"name":"ModSecurity","slug":"ModSecurity","count":1,"path":"api/tags/ModSecurity.json"}],"author":{"name":"Moses","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"ä¸€ä½æ­£åœ¨é‡å¡‘çŸ¥è¯†çš„æŠ€æœ¯äºº","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}