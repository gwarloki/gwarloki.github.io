{"title":"å¼€æºWAFè°ƒç ”ä¹‹äº§å“é€‰å‹-AIhttps","uid":"80f3746730bf9c3463eb9ffedee128cb","slug":"å¼€æºWAF-hihttps","date":"2022-06-20T08:44:21.468Z","updated":"2022-10-26T10:07:24.003Z","comments":true,"path":"api/articles/å¼€æºWAF-hihttps.json","keywords":null,"cover":"https://gtwallpaper.org/sites/default/files/wallpaper/159446/abrams-falls-wallpapers-159446-1758-3706849.png","content":"<h1 id=\"ç®€ä»‹\"><a href=\"#ç®€ä»‹\" class=\"headerlink\" title=\"ç®€ä»‹\"></a>ç®€ä»‹</h1><p>aihttpsæ˜¯hihttpsçš„å‡çº§ç‰ˆï¼Œé¦–æ¬¾åŸºäº<code>æœºå™¨å­¦ä¹ </code>ã€è‡ªä¸»å¯¹æŠ—æœªçŸ¥æ”»å‡»çš„é«˜æ€§èƒ½WEBåº”ç”¨é˜²ç«å¢™ï¼ˆ SSL WAFï¼‰ï¼Œæºç å®Œæ•´å¹¶ä¸”å…¼å®¹<code>ModSecurity</code>æ­£åˆ™è§„åˆ™ã€‚<br><strong>ğŸ“¢è¯¥é¡¹ç›®ä¸ªäººå¼€å‘ï¼Œç»´æŠ¤æ€§å·®ï¼Œä¸åˆ—å…¥é€‰å‹åå•ï¼Œå¯ä½œä¸ºäº§å“åŠŸèƒ½å‚è€ƒ</strong><br>â­ï¸DEMO<a href=\"http://59.110.1.135/webroot/html/index/homepage.html\">HIHTTPSä¼ä¸šçº§WAFè®¾å¤‡</a></p>\n<h2 id=\"åŠŸèƒ½\"><a href=\"#åŠŸèƒ½\" class=\"headerlink\" title=\"åŠŸèƒ½\"></a>åŠŸèƒ½</h2><ul>\n<li>æ¶æ„Webæ¼æ´æ‰«æ</li>\n<li>æ•°æ®åº“SQLæ³¨å…¥</li>\n<li>è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSS)</li>\n<li>CC  &amp; DDOSé˜²æŠ¤</li>\n<li>å¯†ç æš´åŠ›ç ´è§£</li>\n<li>å±é™©æ–‡ä»¶ä¸Šä¼ æ£€æµ‹</li>\n<li>éæ³•URL&#x2F;æ–‡ä»¶è®¿é—®</li>\n<li>å…¼å®¹OWASPçš„ModSecurityæ­£åˆ™è§„åˆ™</li>\n<li>epollæ¨¡å‹å•æ ¸æ•°ä¸‡å¹¶å‘è¿æ¥</li>\n<li>æ— ç›‘ç£æœºå™¨å­¦ä¹ ã€è‡ªä¸»ç”Ÿæˆå¯¹æŠ—è§„åˆ™</li>\n</ul>\n<h1 id=\"ç¼–è¯‘å®‰è£…\"><a href=\"#ç¼–è¯‘å®‰è£…\" class=\"headerlink\" title=\"ç¼–è¯‘å®‰è£…\"></a>ç¼–è¯‘å®‰è£…</h1><ol>\n<li>å®‰è£…opensslå’Œlibpcreåº“<br>  CentOS : <pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">yum install openssl openssl-devel\nyum install -y pcre pcre-devel </code></pre>\n  Debian&#x2F;Ubuntu:<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">sudo apt-get install openssl libssl-dev\napt-get install libpcre3 libpcre3-dev  \n&#96;&#96;&#96;  \n  2. ç¼–è¯‘\n  è§£å‹åˆ°ä»»æ„ç›®å½•ï¼Œmakeåç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶aihttps\n  [rules]æ˜¯è§„åˆ™ç›®å½•ï¼Œ[train]æ˜¯æ ·æœ¬é‡‡é›†ç›®å½•ï¼Œ[vector]æ˜¯è‡ªç„¶è¯­è¨€word2docå‘é‡ç”Ÿæˆç›®å½•ï¼Œ[src]æ˜¯æºç ç›®å½•ã€‚\n \n  \n  3. è§„åˆ™\n  è§„åˆ™æ”¾åœ¨å’ŒaihttpsåŒä¸€çº§çš„rulesç›®å½•ï¼Œæ›´å¤šè§„åˆ™åœ¨[https:&#x2F;&#x2F;github.com&#x2F;SpiderLabs&#x2F;owasp-modsecurity-crs&#x2F;](https:&#x2F;&#x2F;github.com&#x2F;SpiderLabs&#x2F;owasp-modsecurity-crs&#x2F;) ä¸‹è½½ã€‚\n\n  \n  4. è¿è¡Œ\n  é€šå¸¸aihttpså‰ç«¯ç»‘å®š443ç«¯å£ï¼ˆhttpsï¼‰ï¼Œåç«¯åå‘ä»£ç†80ç«¯å£; é¦–å…ˆä¿è¯WebæœåŠ¡å™¨80ç«¯å£è¿è¡Œæ­£å¸¸ï¼Œ443ç«¯å£æ²¡å ç”¨ã€‚  \n  .&#x2F;aihttpsé»˜è®¤è¯»å–å½“å‰ç›®å½•ä¸‹çš„confg.cfgæ–‡ä»¶ï¼Œ  æˆ–è€….&#x2F;aihttps --config &#x2F;dir&#x2F;config.cfgï¼Œ æ‰“å°å‡ºè§„åˆ™å°±æˆåŠŸã€‚\n  # æµ‹è¯•\n  1.ModSecurityè§„åˆ™æµ‹è¯•\n  rules&#x2F;main.ruleé»˜è®¤åŠ è½½äº†ä¸€æ¡SQLè¯­å¥æ£€æµ‹è§„åˆ™ï¼Œå¯ä»¥è®¿é—®https:&#x2F;&#x2F;serverip&#x2F;select.html?testsql&#x3D;delete * from test\n  æˆ–è€…ç”¨Kaliç³»ç»Ÿçš„æ¼æ´æ‰«æå™¨niktoè¿è¡Œï¼š.&#x2F;nikto  -host serverip -ssl -port 443 -C all\n  å¦‚æœäº§ç”Ÿäº†æŠ¥è­¦è®°å½•ï¼Œåˆ™ä»£è¡¨æ­£å¸¸ï¼\n  \n  \n  2.æœºå™¨å­¦ä¹ &#x2F;è‡ªä¸»å¯¹æŠ—è§„åˆ™æµ‹è¯•æ–¹æ³•ï¼š\n  \n  æœºå™¨å­¦ä¹ æ˜¯æ ¸å¿ƒï¼Œä½†é‡‡é›†æ ·æœ¬éœ€è¦ä¸€å®šæ—¶é—´ï¼Œä¸ºäº†æ–¹ä¾¿æµ‹è¯•ï¼Œé»˜è®¤äº†ä¸€æ¡aihttps.htmlå¯¹æŠ—è§„åˆ™ï¼š\n  å¦‚æœè®¿é—®https:&#x2F;&#x2F;serverip&#x2F;aihttps.html?id&#x3D;123é‡‡é›†åˆ°çš„æ ·æœ¬å¤§äº99%éƒ½æ˜¯è¿™ç§å½¢æ€ï¼Œé‚£ä¹ˆä¸‹é¢çš„ç½‘å€éƒ½å°†äº§ç”Ÿæ”»å‡»æŠ¥è­¦ï¼š\n  &#96;&#96;&#96;md\n  https:&#x2F;&#x2F;serverip&#x2F;aihttps.html?id&#x3D;123&#39; or 1&#x3D;&#39;1\n  https:&#x2F;&#x2F;serverip&#x2F;aihttps.html?id&#x3D;&lt;script&gt;alert(1);&lt;&#x2F;script&gt;\n  https:&#x2F;&#x2F;serverip&#x2F;aihttps.html?id&#x3D;1234567890&amp;t&#x3D;123\n  https:&#x2F;&#x2F;serverip&#x2F;aihttps.html?id&#x3D;abc</code></pre>\n  3ã€è¦æµ‹è¯•å¹¶å‘è¿æ¥ï¼Œå¯ä»¥ç”¨wrkç­‰å·¥å…·åœ¨ç›¸åŒç¯å¢ƒæµ‹è¯•æ¯”nginxåå‘ä»£ç†çš„æ€§èƒ½æ›´å¼ºã€‚<br>  wrk -c 25 -t 25 -d 10 <a href=\"https://127.0.0.1/\">https://127.0.0.1/</a></li>\n</ol>\n<h2 id=\"é˜²æŠ¤è§„åˆ™\"><a href=\"#é˜²æŠ¤è§„åˆ™\" class=\"headerlink\" title=\"é˜²æŠ¤è§„åˆ™\"></a>é˜²æŠ¤è§„åˆ™</h2><table>\n<thead>\n<tr>\n<th>åºå·</th>\n<th>è§„åˆ™åˆ†ç±»åç§°</th>\n<th>è§„åˆ™æ–‡ä»¶å</th>\n<th>çŠ¶æ€</th>\n<th>è®¾ç½®</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>1</td>\n<td>SQLæ³¨å…¥</td>\n<td>REQUEST-942-APPLICATION-ATTACK-SQLI.conf</td>\n<td>å·²å¯ç”¨</td>\n<td></td>\n</tr>\n<tr>\n<td>2</td>\n<td>XSSæ”»å‡»</td>\n<td>REQUEST-941-APPLICATION-ATTACK-XSS.conf</td>\n<td>å·²å¯ç”¨</td>\n<td></td>\n</tr>\n<tr>\n<td>3</td>\n<td>é»‘å®¢å·¥å…·æ¶æ„æ‰«æ</td>\n<td>REQUEST-913-SCANNER-DETECTION.conf</td>\n<td>å·²å¯ç”¨</td>\n<td></td>\n</tr>\n<tr>\n<td>4</td>\n<td>å¯†ç æš´åŠ›ç ´è§£</td>\n<td>RREQUEST-20-APPLICATION-Brute-PASS.conf</td>\n<td>å·²å¯ç”¨</td>\n<td></td>\n</tr>\n<tr>\n<td>5</td>\n<td>CC &amp; DDOSæ”»å‡»</td>\n<td>REQUEST-20-APPLICATION-CC-DDOS.conf</td>\n<td>å·²å¯ç”¨</td>\n<td></td>\n</tr>\n<tr>\n<td>6</td>\n<td>æ¶æ„æ¼æ´æ¢æµ‹</td>\n<td>REQUEST-102-WWW-RULES.conf</td>\n<td>å·²å¯ç”¨</td>\n<td></td>\n</tr>\n<tr>\n<td>7</td>\n<td>è¿œç¨‹æ‰§è¡Œä»»æ„å‘½ä»¤æ¼æ´</td>\n<td>REQUEST-932-APPLICATION-ATTACK-RCE.conf</td>\n<td>å·²å¯ç”¨</td>\n<td></td>\n</tr>\n<tr>\n<td>8</td>\n<td>æœºå™¨å­¦ä¹ </td>\n<td>REQUEST-888-ML-RULES.conf</td>\n<td>å·²å¯ç”¨</td>\n<td></td>\n</tr>\n<tr>\n<td>9</td>\n<td>äººå·¥æ™ºèƒ½</td>\n<td>REQUEST-188-APPLICATION-EXPERT.conf</td>\n<td>å·²å¯ç”¨</td>\n<td></td>\n</tr>\n</tbody></table>\n<h2 id=\"è¿è¡Œè®¾ç½®\"><a href=\"#è¿è¡Œè®¾ç½®\" class=\"headerlink\" title=\"è¿è¡Œè®¾ç½®\"></a>è¿è¡Œè®¾ç½®</h2><p> <strong>X-Real-IP X-Forwarded-For</strong><br> <strong>Ali-CDN-Real-IP</strong><br> <img src=\"http://img.moses.wang/20220620171314.png\"></p>\n<h2 id=\"è¿è¡ŒçŠ¶æ€\"><a href=\"#è¿è¡ŒçŠ¶æ€\" class=\"headerlink\" title=\"è¿è¡ŒçŠ¶æ€\"></a>è¿è¡ŒçŠ¶æ€</h2><p> <img src=\"http://img.moses.wang/20220620171550.png\"></p>\n","text":"ç®€ä»‹aihttpsæ˜¯hihttpsçš„å‡çº§ç‰ˆï¼Œé¦–æ¬¾åŸºäºæœºå™¨å­¦ä¹ ã€è‡ªä¸»å¯¹æŠ—æœªçŸ¥æ”»å‡»çš„é«˜æ€§èƒ½WEBåº”ç”¨é˜²ç«å¢™ï¼ˆ SSL WAFï¼‰ï¼Œæºç å®Œæ•´å¹¶ä¸”å…¼å®¹ModSecurityæ­£åˆ™è§„åˆ™ã€‚ğŸ“¢è¯¥é¡¹ç›®ä¸ªäººå¼€å‘ï¼Œç»´æŠ¤æ€§å·®ï¼Œä¸åˆ—å…¥é€‰å‹åå•ï¼Œå¯ä½œä¸ºäº§å“åŠŸèƒ½å‚è€ƒâ­ï¸DEMOHIHTTPSä¼ä¸šçº§WAFè®¾å¤‡ åŠŸèƒ½...","link":"","photos":[],"count_time":{"symbolsCount":"2.4k","symbolsTime":"2 mins."},"categories":[{"name":"å¼€æºWAFäº§å“é€‰å‹","slug":"å¼€æºWAFäº§å“é€‰å‹","count":7,"path":"api/categories/å¼€æºWAFäº§å“é€‰å‹.json"}],"tags":[{"name":"Nginx","slug":"Nginx","count":7,"path":"api/tags/Nginx.json"},{"name":"å¼€æºWAFäº§å“é€‰å‹","slug":"å¼€æºWAFäº§å“é€‰å‹","count":7,"path":"api/tags/å¼€æºWAFäº§å“é€‰å‹.json"},{"name":"å®‰å…¨å»ºè®¾","slug":"å®‰å…¨å»ºè®¾","count":7,"path":"api/tags/å®‰å…¨å»ºè®¾.json"},{"name":"WAF","slug":"WAF","count":6,"path":"api/tags/WAF.json"},{"name":"modsecurity","slug":"modsecurity","count":2,"path":"api/tags/modsecurity.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E7%AE%80%E4%BB%8B\"><span class=\"toc-text\">ç®€ä»‹</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%8A%9F%E8%83%BD\"><span class=\"toc-text\">åŠŸèƒ½</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E7%BC%96%E8%AF%91%E5%AE%89%E8%A3%85\"><span class=\"toc-text\">ç¼–è¯‘å®‰è£…</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E9%98%B2%E6%8A%A4%E8%A7%84%E5%88%99\"><span class=\"toc-text\">é˜²æŠ¤è§„åˆ™</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E8%BF%90%E8%A1%8C%E8%AE%BE%E7%BD%AE\"><span class=\"toc-text\">è¿è¡Œè®¾ç½®</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E8%BF%90%E8%A1%8C%E7%8A%B6%E6%80%81\"><span class=\"toc-text\">è¿è¡ŒçŠ¶æ€</span></a></li></ol></li></ol>","author":{"name":"Moses","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"ä¸€ä½æ­£åœ¨é‡å¡‘çŸ¥è¯†çš„æŠ€æœ¯äºº","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"è½¯ä»¶æˆåˆ†åˆ†æ-OpenSCA","uid":"6da9a10f7f69267b09cc355dd9f52db7","slug":"OpenSCA","date":"2022-06-22T01:09:00.000Z","updated":"2022-10-26T08:42:13.438Z","comments":true,"path":"api/articles/OpenSCA.json","keywords":null,"cover":"https://gtwallpaper.org/sites/default/files/wallpaper/159414/4k-backlit-dawn-wallpapers-159414-29451-52642.png","text":"OpenSCA0x01ç®€ä»‹OpenSCAæ˜¯SCAæŠ€æœ¯åŸç†çš„å®ç°ã€‚ä½œä¸ºæ‚¬é•œå®‰å…¨ (opens new window)æ——ä¸‹æºé‰´OSSå¼€æºå¨èƒç®¡æ§äº§å“ (opens new window)çš„å¼€æºç‰ˆæœ¬ï¼ŒOpenSCAç»§æ‰¿äº†æºé‰´OSSçš„å¤šæºSCAå¼€æºåº”ç”¨å®‰å…¨ç¼ºé™·æ£€æµ‹ç­‰æ ¸å¿ƒèƒ½åŠ›ï¼Œé€šè¿‡è½¯ä»¶æˆåˆ†...","link":"","photos":[],"count_time":{"symbolsCount":"12k","symbolsTime":"11 mins."},"categories":[{"name":"è½¯ä»¶ä¾›åº”é“¾å®‰å…¨","slug":"è½¯ä»¶ä¾›åº”é“¾å®‰å…¨","count":26,"path":"api/categories/è½¯ä»¶ä¾›åº”é“¾å®‰å…¨.json"}],"tags":[{"name":"SCA","slug":"SCA","count":15,"path":"api/tags/SCA.json"},{"name":"è½¯ä»¶æˆåˆ†åˆ†æå·¥å…·","slug":"è½¯ä»¶æˆåˆ†åˆ†æå·¥å…·","count":5,"path":"api/tags/è½¯ä»¶æˆåˆ†åˆ†æå·¥å…·.json"},{"name":"è½¯ä»¶ä¾›åº”é“¾å®‰å…¨","slug":"è½¯ä»¶ä¾›åº”é“¾å®‰å…¨","count":11,"path":"api/tags/è½¯ä»¶ä¾›åº”é“¾å®‰å…¨.json"},{"name":"opensca","slug":"opensca","count":1,"path":"api/tags/opensca.json"},{"name":"æ‚¬é•œå®‰å…¨","slug":"æ‚¬é•œå®‰å…¨","count":1,"path":"api/tags/æ‚¬é•œå®‰å…¨.json"}],"author":{"name":"Moses","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"ä¸€ä½æ­£åœ¨é‡å¡‘çŸ¥è¯†çš„æŠ€æœ¯äºº","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"å¼€æºè½¯ä»¶é€‰å‹åŠå®‰å…¨æŒ‡æ ‡å‚è€ƒ","uid":"8ee8224489aaec6996f4a5509d1757b4","slug":"å¼€æºè½¯ä»¶é€‰å‹åŠå®‰å…¨æŒ‡æ ‡å‚è€ƒ","date":"2022-06-20T01:01:00.000Z","updated":"2022-10-26T08:14:49.648Z","comments":true,"path":"api/articles/å¼€æºè½¯ä»¶é€‰å‹åŠå®‰å…¨æŒ‡æ ‡å‚è€ƒ.json","keywords":null,"cover":"https://gtwallpaper.org/sites/default/files/wallpaper/159447/abstract-ink-wallpapers-159447-4124-7248759.png","text":"å¼€æºè½¯ä»¶é€‰å‹åŠå®‰å…¨æŒ‡æ ‡å‚è€ƒå‚è€ƒæ¦‚è¿°å’ŒèƒŒæ™¯å¼€æºè½¯ä»¶ä¾›åº”é“¾é£é™© å®‰å…¨æ¼æ´ å®‰å…¨æ¼æ´åœ¨ç”Ÿæ€ä¸­æ™®éå­˜åœ¨ è½¯ä»¶ä¾›åº”é“¾ä¸­çš„å®‰å…¨æ¼æ´å½±å“å¹¿æ³› å®‰å…¨æ¼æ´å±å®³ä¸¥é‡ æ¶æ„è½¯ä»¶ æ¶æ„è½¯ä»¶æ„ŸæŸ“æ–¹å¼å¤šæ ·ã€ä¸Šä¸‹æ¸¸æŠ•æ¯’ æ¶æ„è½¯ä»¶å½±å“ è½¯ä»¶è®¸å¯è¯ è½¯ä»¶è®¸å¯è¯è¿åé£é™© è½¯ä»¶è®¸å¯è¯ä¿®æ”¹é£é™© è½¯ä»¶ç»´æŠ¤ å¼€æºè½¯ä»¶å¼€å‘è€…...","link":"","photos":[],"count_time":{"symbolsCount":"3.4k","symbolsTime":"3 mins."},"categories":[{"name":"è½¯ä»¶ä¾›åº”é“¾å®‰å…¨","slug":"è½¯ä»¶ä¾›åº”é“¾å®‰å…¨","count":26,"path":"api/categories/è½¯ä»¶ä¾›åº”é“¾å®‰å…¨.json"}],"tags":[{"name":"å¼€æºè½¯ä»¶å®‰å…¨æŒ‡æ ‡","slug":"å¼€æºè½¯ä»¶å®‰å…¨æŒ‡æ ‡","count":1,"path":"api/tags/å¼€æºè½¯ä»¶å®‰å…¨æŒ‡æ ‡.json"},{"name":"openbase","slug":"openbase","count":1,"path":"api/tags/openbase.json"}],"author":{"name":"Moses","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"ä¸€ä½æ­£åœ¨é‡å¡‘çŸ¥è¯†çš„æŠ€æœ¯äºº","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}