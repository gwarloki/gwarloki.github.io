{"title":"开源WAF调研之产品选型-AIhttps","uid":"80f3746730bf9c3463eb9ffedee128cb","slug":"开源WAF-hihttps","date":"2022-06-20T08:44:21.468Z","updated":"2022-10-26T10:07:24.003Z","comments":true,"path":"api/articles/开源WAF-hihttps.json","keywords":null,"cover":"https://gtwallpaper.org/sites/default/files/wallpaper/159446/abrams-falls-wallpapers-159446-1758-3706849.png","content":"<h1 id=\"简介\"><a href=\"#简介\" class=\"headerlink\" title=\"简介\"></a>简介</h1><p>aihttps是hihttps的升级版，首款基于<code>机器学习</code>、自主对抗未知攻击的高性能WEB应用防火墙（ SSL WAF），源码完整并且兼容<code>ModSecurity</code>正则规则。<br><strong>📢该项目个人开发，维护性差，不列入选型名单，可作为产品功能参考</strong><br>⭐️DEMO<a href=\"http://59.110.1.135/webroot/html/index/homepage.html\">HIHTTPS企业级WAF设备</a></p>\n<h2 id=\"功能\"><a href=\"#功能\" class=\"headerlink\" title=\"功能\"></a>功能</h2><ul>\n<li>恶意Web漏洞扫描</li>\n<li>数据库SQL注入</li>\n<li>跨站脚本攻击（XSS)</li>\n<li>CC  &amp; DDOS防护</li>\n<li>密码暴力破解</li>\n<li>危险文件上传检测</li>\n<li>非法URL&#x2F;文件访问</li>\n<li>兼容OWASP的ModSecurity正则规则</li>\n<li>epoll模型单核数万并发连接</li>\n<li>无监督机器学习、自主生成对抗规则</li>\n</ul>\n<h1 id=\"编译安装\"><a href=\"#编译安装\" class=\"headerlink\" title=\"编译安装\"></a>编译安装</h1><ol>\n<li>安装openssl和libpcre库<br>  CentOS : <pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">yum install openssl openssl-devel\nyum install -y pcre pcre-devel </code></pre>\n  Debian&#x2F;Ubuntu:<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">sudo apt-get install openssl libssl-dev\napt-get install libpcre3 libpcre3-dev  \n&#96;&#96;&#96;  \n  2. 编译\n  解压到任意目录，make后生成可执行文件aihttps\n  [rules]是规则目录，[train]是样本采集目录，[vector]是自然语言word2doc向量生成目录，[src]是源码目录。\n \n  \n  3. 规则\n  规则放在和aihttps同一级的rules目录，更多规则在[https:&#x2F;&#x2F;github.com&#x2F;SpiderLabs&#x2F;owasp-modsecurity-crs&#x2F;](https:&#x2F;&#x2F;github.com&#x2F;SpiderLabs&#x2F;owasp-modsecurity-crs&#x2F;) 下载。\n\n  \n  4. 运行\n  通常aihttps前端绑定443端口（https），后端反向代理80端口; 首先保证Web服务器80端口运行正常，443端口没占用。  \n  .&#x2F;aihttps默认读取当前目录下的confg.cfg文件，  或者.&#x2F;aihttps --config &#x2F;dir&#x2F;config.cfg， 打印出规则就成功。\n  # 测试\n  1.ModSecurity规则测试\n  rules&#x2F;main.rule默认加载了一条SQL语句检测规则，可以访问https:&#x2F;&#x2F;serverip&#x2F;select.html?testsql&#x3D;delete * from test\n  或者用Kali系统的漏洞扫描器nikto运行：.&#x2F;nikto  -host serverip -ssl -port 443 -C all\n  如果产生了报警记录，则代表正常！\n  \n  \n  2.机器学习&#x2F;自主对抗规则测试方法：\n  \n  机器学习是核心，但采集样本需要一定时间，为了方便测试，默认了一条aihttps.html对抗规则：\n  如果访问https:&#x2F;&#x2F;serverip&#x2F;aihttps.html?id&#x3D;123采集到的样本大于99%都是这种形态，那么下面的网址都将产生攻击报警：\n  &#96;&#96;&#96;md\n  https:&#x2F;&#x2F;serverip&#x2F;aihttps.html?id&#x3D;123&#39; or 1&#x3D;&#39;1\n  https:&#x2F;&#x2F;serverip&#x2F;aihttps.html?id&#x3D;&lt;script&gt;alert(1);&lt;&#x2F;script&gt;\n  https:&#x2F;&#x2F;serverip&#x2F;aihttps.html?id&#x3D;1234567890&amp;t&#x3D;123\n  https:&#x2F;&#x2F;serverip&#x2F;aihttps.html?id&#x3D;abc</code></pre>\n  3、要测试并发连接，可以用wrk等工具在相同环境测试比nginx反向代理的性能更强。<br>  wrk -c 25 -t 25 -d 10 <a href=\"https://127.0.0.1/\">https://127.0.0.1/</a></li>\n</ol>\n<h2 id=\"防护规则\"><a href=\"#防护规则\" class=\"headerlink\" title=\"防护规则\"></a>防护规则</h2><table>\n<thead>\n<tr>\n<th>序号</th>\n<th>规则分类名称</th>\n<th>规则文件名</th>\n<th>状态</th>\n<th>设置</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>1</td>\n<td>SQL注入</td>\n<td>REQUEST-942-APPLICATION-ATTACK-SQLI.conf</td>\n<td>已启用</td>\n<td></td>\n</tr>\n<tr>\n<td>2</td>\n<td>XSS攻击</td>\n<td>REQUEST-941-APPLICATION-ATTACK-XSS.conf</td>\n<td>已启用</td>\n<td></td>\n</tr>\n<tr>\n<td>3</td>\n<td>黑客工具恶意扫描</td>\n<td>REQUEST-913-SCANNER-DETECTION.conf</td>\n<td>已启用</td>\n<td></td>\n</tr>\n<tr>\n<td>4</td>\n<td>密码暴力破解</td>\n<td>RREQUEST-20-APPLICATION-Brute-PASS.conf</td>\n<td>已启用</td>\n<td></td>\n</tr>\n<tr>\n<td>5</td>\n<td>CC &amp; DDOS攻击</td>\n<td>REQUEST-20-APPLICATION-CC-DDOS.conf</td>\n<td>已启用</td>\n<td></td>\n</tr>\n<tr>\n<td>6</td>\n<td>恶意漏洞探测</td>\n<td>REQUEST-102-WWW-RULES.conf</td>\n<td>已启用</td>\n<td></td>\n</tr>\n<tr>\n<td>7</td>\n<td>远程执行任意命令漏洞</td>\n<td>REQUEST-932-APPLICATION-ATTACK-RCE.conf</td>\n<td>已启用</td>\n<td></td>\n</tr>\n<tr>\n<td>8</td>\n<td>机器学习</td>\n<td>REQUEST-888-ML-RULES.conf</td>\n<td>已启用</td>\n<td></td>\n</tr>\n<tr>\n<td>9</td>\n<td>人工智能</td>\n<td>REQUEST-188-APPLICATION-EXPERT.conf</td>\n<td>已启用</td>\n<td></td>\n</tr>\n</tbody></table>\n<h2 id=\"运行设置\"><a href=\"#运行设置\" class=\"headerlink\" title=\"运行设置\"></a>运行设置</h2><p> <strong>X-Real-IP X-Forwarded-For</strong><br> <strong>Ali-CDN-Real-IP</strong><br> <img src=\"http://img.moses.wang/20220620171314.png\"></p>\n<h2 id=\"运行状态\"><a href=\"#运行状态\" class=\"headerlink\" title=\"运行状态\"></a>运行状态</h2><p> <img src=\"http://img.moses.wang/20220620171550.png\"></p>\n","text":"简介aihttps是hihttps的升级版，首款基于机器学习、自主对抗未知攻击的高性能WEB应用防火墙（ SSL WAF），源码完整并且兼容ModSecurity正则规则。📢该项目个人开发，维护性差，不列入选型名单，可作为产品功能参考⭐️DEMOHIHTTPS企业级WAF设备 功能...","link":"","photos":[],"count_time":{"symbolsCount":"2.4k","symbolsTime":"2 mins."},"categories":[{"name":"开源WAF产品选型","slug":"开源WAF产品选型","count":7,"path":"api/categories/开源WAF产品选型.json"}],"tags":[{"name":"Nginx","slug":"Nginx","count":7,"path":"api/tags/Nginx.json"},{"name":"开源WAF产品选型","slug":"开源WAF产品选型","count":7,"path":"api/tags/开源WAF产品选型.json"},{"name":"安全建设","slug":"安全建设","count":7,"path":"api/tags/安全建设.json"},{"name":"WAF","slug":"WAF","count":6,"path":"api/tags/WAF.json"},{"name":"modsecurity","slug":"modsecurity","count":2,"path":"api/tags/modsecurity.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E7%AE%80%E4%BB%8B\"><span class=\"toc-text\">简介</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%8A%9F%E8%83%BD\"><span class=\"toc-text\">功能</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E7%BC%96%E8%AF%91%E5%AE%89%E8%A3%85\"><span class=\"toc-text\">编译安装</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E9%98%B2%E6%8A%A4%E8%A7%84%E5%88%99\"><span class=\"toc-text\">防护规则</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E8%BF%90%E8%A1%8C%E8%AE%BE%E7%BD%AE\"><span class=\"toc-text\">运行设置</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E8%BF%90%E8%A1%8C%E7%8A%B6%E6%80%81\"><span class=\"toc-text\">运行状态</span></a></li></ol></li></ol>","author":{"name":"Moses","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"一位正在重塑知识的技术人","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"软件成分分析-OpenSCA","uid":"6da9a10f7f69267b09cc355dd9f52db7","slug":"OpenSCA","date":"2022-06-22T01:09:00.000Z","updated":"2022-10-26T08:42:13.438Z","comments":true,"path":"api/articles/OpenSCA.json","keywords":null,"cover":"https://gtwallpaper.org/sites/default/files/wallpaper/159414/4k-backlit-dawn-wallpapers-159414-29451-52642.png","text":"OpenSCA0x01简介OpenSCA是SCA技术原理的实现。作为悬镜安全 (opens new window)旗下源鉴OSS开源威胁管控产品 (opens new window)的开源版本，OpenSCA继承了源鉴OSS的多源SCA开源应用安全缺陷检测等核心能力，通过软件成分...","link":"","photos":[],"count_time":{"symbolsCount":"12k","symbolsTime":"11 mins."},"categories":[{"name":"软件供应链安全","slug":"软件供应链安全","count":26,"path":"api/categories/软件供应链安全.json"}],"tags":[{"name":"SCA","slug":"SCA","count":15,"path":"api/tags/SCA.json"},{"name":"软件成分分析工具","slug":"软件成分分析工具","count":5,"path":"api/tags/软件成分分析工具.json"},{"name":"软件供应链安全","slug":"软件供应链安全","count":11,"path":"api/tags/软件供应链安全.json"},{"name":"opensca","slug":"opensca","count":1,"path":"api/tags/opensca.json"},{"name":"悬镜安全","slug":"悬镜安全","count":1,"path":"api/tags/悬镜安全.json"}],"author":{"name":"Moses","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"一位正在重塑知识的技术人","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"开源软件选型及安全指标参考","uid":"8ee8224489aaec6996f4a5509d1757b4","slug":"开源软件选型及安全指标参考","date":"2022-06-20T01:01:00.000Z","updated":"2022-10-26T08:14:49.648Z","comments":true,"path":"api/articles/开源软件选型及安全指标参考.json","keywords":null,"cover":"https://gtwallpaper.org/sites/default/files/wallpaper/159447/abstract-ink-wallpapers-159447-4124-7248759.png","text":"开源软件选型及安全指标参考参考概述和背景开源软件供应链风险 安全漏洞 安全漏洞在生态中普遍存在 软件供应链中的安全漏洞影响广泛 安全漏洞危害严重 恶意软件 恶意软件感染方式多样、上下游投毒 恶意软件影响 软件许可证 软件许可证违反风险 软件许可证修改风险 软件维护 开源软件开发者...","link":"","photos":[],"count_time":{"symbolsCount":"3.4k","symbolsTime":"3 mins."},"categories":[{"name":"软件供应链安全","slug":"软件供应链安全","count":26,"path":"api/categories/软件供应链安全.json"}],"tags":[{"name":"开源软件安全指标","slug":"开源软件安全指标","count":1,"path":"api/tags/开源软件安全指标.json"},{"name":"openbase","slug":"openbase","count":1,"path":"api/tags/openbase.json"}],"author":{"name":"Moses","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"一位正在重塑知识的技术人","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}