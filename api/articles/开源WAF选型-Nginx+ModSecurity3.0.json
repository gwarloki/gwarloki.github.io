{"title":"å¼€æºWAFè°ƒç ”ä¹‹äº§å“é€‰å‹-Nginx+ModSecurity3.0","uid":"35772fd534664d45a9bf135dc04685bc","slug":"å¼€æºWAFé€‰å‹-Nginx+ModSecurity3.0","date":"2022-06-09T06:39:16.000Z","updated":"2022-10-26T10:10:07.278Z","comments":true,"path":"api/articles/å¼€æºWAFé€‰å‹-Nginx+ModSecurity3.0.json","keywords":null,"cover":"https://gtwallpaper.org/sites/default/files/wallpaper/159446/abrams-falls-wallpapers-159446-1969-4235097.png","content":"<h1 id=\"äº§å“ä¿¡æ¯ç®€ä»‹\"><a href=\"#äº§å“ä¿¡æ¯ç®€ä»‹\" class=\"headerlink\" title=\"äº§å“ä¿¡æ¯ç®€ä»‹\"></a>äº§å“ä¿¡æ¯ç®€ä»‹</h1><table>\n<thead>\n<tr>\n<th>åç§°</th>\n<th>å¼€æºåè®®</th>\n<th>å¼€å‘è¯­è¨€</th>\n<th>å¼€æºæ—¶é—´</th>\n<th>æ´»è·ƒåº¦</th>\n<th>ä»£ç è´¨é‡</th>\n<th>æœ€æ–°ç‰ˆæœ¬</th>\n<th>å‚å•†</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>ModSecurity</td>\n<td>BSD 3-Clause License</td>\n<td>Lua</td>\n<td>2013-12-16ï¼ˆ2.7.6ï¼‰</td>\n<td>5.4Kâ­ï¸</td>\n<td>A</td>\n<td>2022-05-31 ï¼ˆ3.1.7ï¼‰</td>\n<td>Trustwave</td>\n</tr>\n</tbody></table>\n<h1 id=\"ModSecurityä»‹ç»\"><a href=\"#ModSecurityä»‹ç»\" class=\"headerlink\" title=\"ModSecurityä»‹ç»\"></a>ModSecurityä»‹ç»</h1><p>ModSecurityæ˜¯ä¸€ä¸ªå¼€æºçš„ã€ç”Ÿäº§çº§åˆ«çš„WAFäº§å“ï¼Œæ ¸å¿ƒç»„æˆéƒ¨åˆ†æ˜¯â€œè§„åˆ™å¼•æ“â€å’Œâ€œè§„åˆ™é›†â€ï¼Œä¸¤è€…çš„å…³ç³»æœ‰ç‚¹åƒæ€æ¯’å¼•æ“å’Œç—…æ¯’ç‰¹å¾åº“ã€‚</p>\n<ul>\n<li><p>è§„åˆ™å¼•æ“ï¼šå®ç°äº†è‡ªå®šä¹‰çš„â€SecRuleâ€è¯­è¨€ï¼Œæœ‰è‡ªå·±ç‰¹å®šçš„è¯­æ³•ã€‚ä½†â€œSecRuleâ€ä¸»è¦åŸºäºæ­£åˆ™è¡¨è¾¾å¼ï¼Œè¿˜æ˜¯ä¸å¤Ÿçµæ´»ï¼Œæ‰€ä»¥åæ¥å¼•å…¥äº†Lua,å®ç°äº†è„šæœ¬åŒ–é…ç½®ã€‚ModSecurityçš„è§„åˆ™å¼•æ“ä½¿ç”¨C++11å®ç°ï¼Œå¯ä»¥ä»<a href=\"https://github.com/SpiderLabs/ModSecurity\">GitHub</a>ä¸Šä¸‹è½½ï¼Œç„¶åé›†æˆè¿›Nginxã€‚å› ä¸ºä»–æ¯”è¾ƒåºå¤§ï¼Œç¼–è¯‘å¾ˆè´¹æ—¶é—´ï¼Œæ‰€ä»¥æœ€å¥½ç¼–è¯‘æˆåŠ¨æ€æ¨¡å—ï¼Œåœ¨é…ç½®æ–‡ä»¶ä¸­ç”¨æŒ‡ä»¤<code>load_module</code>åŠ è½½</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">load_module modules&#x2F;ngx_http_mod</code></pre>\n</li>\n<li><p>è§„åˆ™é›†ï¼šModSecurity æºç æä¾›ä¸€ä¸ªåŸºæœ¬çš„è§„åˆ™é…ç½®æ–‡ä»¶â€œmodsecurity.conf-recommendedâ€ï¼Œä½¿ç”¨å‰è¦æŠŠå®ƒçš„åç¼€æ”¹æˆâ€œconfâ€ã€‚æœ‰äº†è§„åˆ™é›†ï¼Œå°±å¯ä»¥åœ¨ Nginx é…ç½®æ–‡ä»¶é‡ŒåŠ è½½ï¼Œç„¶åå¯åŠ¨è§„åˆ™å¼•æ“ï¼š<code>modsecurity on;modsecurity_rules_file /path/to/modsecurity.conf;â€œmodsecurity.confâ€</code>æ–‡ä»¶é»˜è®¤åªæœ‰æ£€æµ‹åŠŸèƒ½ï¼Œä¸æä¾›å…¥ä¾µé˜»æ–­ï¼Œè¿™æ˜¯ä¸ºäº†é˜²æ­¢è¯¯æ€è¯¯æŠ¥ï¼ŒæŠŠâ€œSecRuleEngineâ€åé¢æ”¹æˆâ€œOnâ€å°±å¯ä»¥å¼€å¯å®Œå…¨çš„é˜²æŠ¤ï¼š<code>#SecRuleEngine DetectionOnlySecRuleEngine On</code>é™¤äº†åŸºæœ¬çš„è§„åˆ™é›†ä¹‹å¤–ï¼ŒModSecurity è¿˜é¢å¤–æä¾›ä¸€ä¸ªæ›´å®Œå–„çš„è§„åˆ™é›†ï¼Œä¸ºç½‘ç«™æä¾›å…¨é¢å¯é çš„ä¿æŠ¤ã€‚è¿™ä¸ªè§„åˆ™é›†çš„å…¨åå«â€œOWASP ModSecurity æ ¸å¿ƒè§„åˆ™é›†â€<a href=\"https://github.com/SpiderLabs/owasp-modsecurity-crs\">CRS</a></p>\n</li>\n</ul>\n<h1 id=\"åŠŸèƒ½\"><a href=\"#åŠŸèƒ½\" class=\"headerlink\" title=\"åŠŸèƒ½\"></a>åŠŸèƒ½</h1><ul>\n<li>å…¼å®¹Â <a href=\"https://github.com/SpiderLabs/ModSecurity\">ModSecurityÂ (opens new window)</a>ã€‚æ­¤åŠŸèƒ½ä»…é™æœ€æ–°çš„ Current ç‰ˆæœ¬ã€‚</li>\n<li>SQL æ³¨å…¥é˜²æŠ¤ï¼ˆPowered ByÂ <a href=\"https://github.com/libinjection/libinjection\">libinjectionÂ (opens new window)</a>ï¼‰ã€‚</li>\n<li>XSS æ”»å‡»é˜²æŠ¤ï¼ˆPowered ByÂ <a href=\"https://github.com/libinjection/libinjection\">libinjectionÂ (opens new window)</a>ï¼‰ã€‚</li>\n<li>æ”¯æŒ IPV4 å’Œ IPV6ã€‚</li>\n<li>æ”¯æŒå¼€å¯éªŒè¯ç ï¼ˆCAPTCHA)ï¼Œæ”¯æŒÂ <a href=\"https://www.hcaptcha.com/\">hCaptchaÂ (opens new window)</a>ã€<a href=\"https://developers.google.com/recaptcha\">reCAPTCHAv2Â (opens new window)</a>å’ŒÂ <a href=\"https://developers.google.com/recaptcha\">reCAPTCHAv3Â (opens new window)</a>ã€‚</li>\n<li>æ”¯æŒè¯†åˆ«å‹å¥½çˆ¬è™«ï¼ˆå¦‚ BaiduSpiderï¼‰å¹¶è‡ªåŠ¨æ”¾è¡Œï¼ˆåŸºäº User-Agent å’Œ IP çš„è¯†åˆ«ï¼‰ã€‚æ­¤åŠŸèƒ½ä»…é™æœ€æ–°çš„ Current ç‰ˆæœ¬ã€‚</li>\n<li>CC é˜²å¾¡ï¼Œè¶…å‡ºé™åˆ¶åè‡ªåŠ¨æ‹‰é»‘å¯¹åº” IP ä¸€æ®µæ—¶é—´æˆ–è€…ä½¿ç”¨éªŒè¯ç åšäººæœºè¯†åˆ«ã€‚</li>\n<li>IP é»‘ç™½åå•ï¼ŒåŒæ—¶æ”¯æŒç±»ä¼¼Â <code>192.168.0.0/16</code>Â å’ŒÂ <code>fe80::/10</code>ï¼Œå³æ”¯æŒç‚¹åˆ†åè¿›åˆ¶å’Œå†’å·åå…­è¿›åˆ¶è¡¨ç¤ºæ³•å’Œç½‘æ®µåˆ’åˆ†ã€‚</li>\n<li>POST é»‘åå•ã€‚</li>\n<li>URL é»‘ç™½åå•</li>\n<li>æŸ¥è¯¢å­—ç¬¦ä¸²ï¼ˆQuery Stringï¼‰é»‘åå•ã€‚</li>\n<li>UserAgent é»‘åå•ã€‚</li>\n<li>Cookie é»‘åå•ã€‚</li>\n<li>Referer é»‘ç™½åå•ã€‚</li>\n</ul>\n<h2 id=\"ModSecurityåŠŸèƒ½\"><a href=\"#ModSecurityåŠŸèƒ½\" class=\"headerlink\" title=\"ModSecurityåŠŸèƒ½\"></a>ModSecurityåŠŸèƒ½</h2><ul>\n<li>SQL Injection (SQLi)ï¼šé˜»æ­¢SQLæ³¨å…¥</li>\n<li>Cross Site Scripting (XSS)ï¼šé˜»æ­¢è·¨ç«™è„šæœ¬æ”»å‡»</li>\n<li>Local File Inclusion (LFI)ï¼šé˜»æ­¢åˆ©ç”¨æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´è¿›è¡Œæ”»å‡»</li>\n<li>Remote File Inclusione(RFI)ï¼šé˜»æ­¢åˆ©ç”¨è¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´è¿›è¡Œæ”»å‡»</li>\n<li>Remote Code Execution (RCE)ï¼šé˜»æ­¢åˆ©ç”¨è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´è¿›è¡Œæ”»å‡»</li>\n<li>PHP Code Injectiodï¼šé˜»æ­¢PHPä»£ç æ³¨å…¥</li>\n<li>HTTP Protocol Violationsï¼šé˜»æ­¢è¿åHTTPåè®®çš„æ¶æ„è®¿é—®</li>\n<li>HTTPoxyï¼šé˜»æ­¢åˆ©ç”¨è¿œç¨‹ä»£ç†æ„ŸæŸ“æ¼æ´è¿›è¡Œæ”»å‡»</li>\n<li>shellshockï¼šé˜»æ­¢åˆ©ç”¨Shellshockæ¼æ´è¿›è¡Œæ”»å‡»</li>\n<li>Session Fixationï¼šé˜»æ­¢åˆ©ç”¨Sessionä¼šè¯IDä¸å˜çš„æ¼æ´è¿›è¡Œæ”»å‡»</li>\n<li>Scanner Detectionï¼šé˜»æ­¢é»‘å®¢æ‰«æç½‘ç«™</li>\n<li>Metadata&#x2F;Error Leakagesï¼šé˜»æ­¢æºä»£ç &#x2F;é”™è¯¯ä¿¡æ¯æ³„éœ²</li>\n<li>Project Honey Pot Blacklistï¼šèœœç½é¡¹ç›®é»‘åå•</li>\n<li>GeoIP Country Blockingï¼šæ ¹æ®åˆ¤æ–­IPåœ°å€å½’å±åœ°æ¥è¿›è¡ŒIPé˜»æ–­</li>\n</ul>\n<h1 id=\"å‡†å¤‡ç¯å¢ƒ\"><a href=\"#å‡†å¤‡ç¯å¢ƒ\" class=\"headerlink\" title=\"å‡†å¤‡ç¯å¢ƒ\"></a>å‡†å¤‡ç¯å¢ƒ</h1><ul>\n<li>æ“ä½œç³»ç»Ÿï¼š<a href=\"http://archive.kernel.org/centos-vault/7.6.1810/isos/x86_64/CentOS-7-x86_64-DVD-1810.iso\">CentOS-7-x86_64-DVD-1810.iso</a></li>\n<li>ModSecurityï¼š3.0</li>\n<li>Nginxï¼š1.16.1</li>\n<li>è™šæ‹Ÿæœºï¼švwareFusion12.2.1 æ¡¥æ¥</li>\n</ul>\n<h1 id=\"å®‰è£…\"><a href=\"#å®‰è£…\" class=\"headerlink\" title=\"å®‰è£…\"></a>å®‰è£…</h1><h3 id=\"æ“ä½œç³»ç»Ÿä¾èµ–\"><a href=\"#æ“ä½œç³»ç»Ÿä¾èµ–\" class=\"headerlink\" title=\"æ“ä½œç³»ç»Ÿä¾èµ–\"></a>æ“ä½œç³»ç»Ÿä¾èµ–</h3><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">yum install -y git wget epel-release\nyum install -y gcc-c++ flex bison yajl yajl-devel curl-devel curl GeoIP-devel doxygen zlib-devel pcre-devel lmdb-devel libxml2-devel ssdeep-devel lua-devel libtool autoconf automake</code></pre>\n<h3 id=\"å®‰è£…ModSecurity\"><a href=\"#å®‰è£…ModSecurity\" class=\"headerlink\" title=\"å®‰è£…ModSecurity\"></a>å®‰è£…ModSecurity</h3><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">cd &#x2F;usr&#x2F;local\ngit clone https:&#x2F;&#x2F;github.com&#x2F;SpiderLabs&#x2F;ModSecurity\ncd ModSecurity\ngit checkout -b v3&#x2F;master origin&#x2F;v3&#x2F;master\ngit submodule init\ngit submodule update\nsh build.sh\n.&#x2F;configure\n# è¾“å‡º\nModSecurity - v3.0.7-1-g9755088 for Linux\n\n Mandatory dependencies\n   + libInjection                                  ....v3.9.2-46-gbfba51f\n   + SecLang tests                                 ....a3d4405\n\n Optional dependencies\n   + GeoIP&#x2F;MaxMind                                 ....found\n      * (GeoIP) v1.5.0\n         -lGeoIP  , -I&#x2F;usr&#x2F;include&#x2F;\n   + LibCURL                                       ....found v7.29.0\n      -lcurl  ,  -DWITH_CURL\n   + YAJL                                          ....found v2.0.4\n      -lyajl  , -DWITH_YAJL\n   + LMDB                                          ....disabled\n   + LibXML2                                       ....found v2.9.1\n      -lxml2 -lz -lm -ldl, -I&#x2F;usr&#x2F;include&#x2F;libxml2 -DWITH_LIBXML2\n   + SSDEEP                                        ....found\n      -lfuzzy -L&#x2F;usr&#x2F;lib64&#x2F;, -DWITH_SSDEEP -I&#x2F;usr&#x2F;include\n   + LUA                                           ....found v501\n      -llua-5.1 -L&#x2F;usr&#x2F;lib64&#x2F;, -DWITH_LUA -DWITH_LUA_5_1 -I&#x2F;usr&#x2F;include\n   + PCRE2                                          ....not found\n\n Other Options\n   + Test Utilities                                ....enabled\n   + SecDebugLog                                   ....enabled\n   + afl fuzzer                                    ....disabled\n   + library examples                              ....enabled\n   + Building parser                               ....disabled\n   + Treating pm operations as critical section    ....disabled\nmake\nmake install</code></pre>\n<h3 id=\"å®‰è£…Nginxä¸ModSecurity-nginx\"><a href=\"#å®‰è£…Nginxä¸ModSecurity-nginx\" class=\"headerlink\" title=\"å®‰è£…Nginxä¸ModSecurity-nginx\"></a>å®‰è£…Nginxä¸ModSecurity-nginx</h3><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">cd &#x2F;usr&#x2F;local\ngit clone https:&#x2F;&#x2F;github.com&#x2F;SpiderLabs&#x2F;ModSecurity-nginx\nwget http:&#x2F;&#x2F;nginx.org&#x2F;download&#x2F;nginx-1.16.1.tar.gz\ntar -xvzf nginx-1.16.1.tar.gz\ncd &#x2F;usr&#x2F;local&#x2F;nginx-1.16.1\n.&#x2F;configure --add-module&#x3D;&#x2F;usr&#x2F;local&#x2F;ModSecurity-nginx\nmake\nmake install</code></pre>\n\n<h1 id=\"éªŒè¯\"><a href=\"#éªŒè¯\" class=\"headerlink\" title=\"éªŒè¯\"></a>éªŒè¯</h1><p>å¯åŠ¨Nginx</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">&#x2F;usr&#x2F;local&#x2F;nginx&#x2F;sbin&#x2F;nginx</code></pre>\n<p>éªŒè¯NginxæœåŠ¡</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">[root@localhost sbin]# curl -i http:&#x2F;&#x2F;127.0.0.1\nHTTP&#x2F;1.1 200 OK\nServer: nginx&#x2F;1.16.1\nDate: Thu, 09 Jun 2022 08:24:59 GMT\nContent-Type: text&#x2F;html\nContent-Length: 612\nLast-Modified: Thu, 09 Jun 2022 08:23:04 GMT\nConnection: keep-alive\nETag: &quot;62a1ade8-264&quot;\nAccept-Ranges: bytes\n\n&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;title&gt;Welcome to nginx!&lt;&#x2F;title&gt;\n&lt;style&gt;\n    body &#123;\n        width: 35em;\n        margin: 0 auto;\n        font-family: Tahoma, Verdana, Arial, sans-serif;\n    &#125;\n&lt;&#x2F;style&gt;\n&lt;&#x2F;head&gt;\n&lt;body&gt;\n&lt;h1&gt;Welcome to nginx!&lt;&#x2F;h1&gt;\n&lt;p&gt;If you see this page, the nginx web server is successfully installed and\nworking. Further configuration is required.&lt;&#x2F;p&gt;\n\n&lt;p&gt;For online documentation and support please refer to\n&lt;a href&#x3D;&quot;http:&#x2F;&#x2F;nginx.org&#x2F;&quot;&gt;nginx.org&lt;&#x2F;a&gt;.&lt;br&#x2F;&gt;\nCommercial support is available at\n&lt;a href&#x3D;&quot;http:&#x2F;&#x2F;nginx.com&#x2F;&quot;&gt;nginx.com&lt;&#x2F;a&gt;.&lt;&#x2F;p&gt;\n\n&lt;p&gt;&lt;em&gt;Thank you for using nginx.&lt;&#x2F;em&gt;&lt;&#x2F;p&gt;\n&lt;&#x2F;body&gt;\n&lt;&#x2F;html&gt;</code></pre>\n<p>PSï¼šæµè§ˆå™¨è®¿é—®å¤±è´¥ï¼Œä¸´æ—¶å…³é—­é˜²ç«å¢™éªŒè¯</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">[root@localhost sbin] systemctl stop firewalld.service</code></pre>\n<p>æµè§ˆå™¨è®¿é—®<br><img src=\"http://img.moses.wang/20220609163456.png\"></p>\n<h1 id=\"é…ç½®\"><a href=\"#é…ç½®\" class=\"headerlink\" title=\"é…ç½®\"></a>é…ç½®</h1><ol>\n<li>åˆ›å»ºç”¨äºå­˜æ”¾é…ç½®çš„æ–‡ä»¶å¤¹<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">[root@localhost conf]# mkdir &#x2F;usr&#x2F;local&#x2F;nginx&#x2F;conf&#x2F;modsecurity</code></pre></li>\n<li>å¤åˆ¶å¹¶é‡å‘½åé…ç½®æ–‡ä»¶<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">[root@localhost conf] cp &#x2F;usr&#x2F;local&#x2F;ModSecurity&#x2F;modsecurity.conf-recommended &#x2F;usr&#x2F;local&#x2F;nginx&#x2F;conf&#x2F;modsecurity&#x2F;\n# é‡å‘½åé…ç½®æ–‡ä»¶\n[root@localhost] cd &#x2F;usr&#x2F;local&#x2F;nginx&#x2F;conf&#x2F;modsecurity&#x2F; &amp;&amp; rename modsecurity.conf-recommended modsecurity.conf *\n[root@localhost modsecurity] cp &#x2F;usr&#x2F;local&#x2F;ModSecurity&#x2F;unicode.mapping &#x2F;usr&#x2F;local&#x2F;nginx&#x2F;conf&#x2F;modsecurity&#x2F;</code></pre></li>\n<li><a href=\"http://www.modsecurity.cn/download/corerule/owasp-modsecurity-crs-3.3-dev.zip\">ä¸‹è½½è§„åˆ™æ–‡ä»¶å‹ç¼©åŒ…</a><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"># ä¸‹è½½è§„åˆ™åŒ…\n[root@localhost local] wget http:&#x2F;&#x2F;www.modsecurity.cn&#x2F;download&#x2F;corerule&#x2F;owasp-modsecurity-crs-3.3-dev.zip\n# è§£å‹\n[root@localhost local] unzip owasp-modsecurity-crs-3.3-dev.zip\n# å¤åˆ¶crs-setup.conf.example\n[root@localhost owasp-modsecurity-crs-3.3-dev] cp crs-setup.conf.example &#x2F;usr&#x2F;local&#x2F;nginx&#x2F;conf&#x2F;modsecurity&#x2F;\n# é‡å‘½åæ–‡ä»¶\n[root@localhost] cd &#x2F;usr&#x2F;local&#x2F;nginx&#x2F;conf&#x2F;modsecurity&#x2F; &amp;&amp; rename modsecurity.conf.example crs-setup.conf *\n# å¤åˆ¶ruleæ–‡ä»¶å¤¹\n[root@localhost owasp-modsecurity-crs-3.3-dev] cp -r rules &#x2F;usr&#x2F;local&#x2F;nginx&#x2F;conf&#x2F;modsecurity&#x2F;\n# ä¿®æ”¹æ–‡ä»¶å,å¯ä»¥å°†è‡ªå·±å†™çš„è§„åˆ™æ”¾åœ¨999 900è¿™ä¸¤ä¸ªæ–‡ä»¶ä¸­\n[root@localhost rules] rename RESPONSE-999-EXCLUSION-RULES-AFTER-CRS.conf.example RESPONSE-999-EXCLUSION-RULES-AFTER-CRS.conf *\n[root@localhost rules] rename REQUEST-900-EXCLUSION-RULES-BEFORE-CRS.conf.example REQUEST-900-EXCLUSION-RULES-BEFORE-CRS.conf *</code></pre></li>\n<li>ç¼–è¾‘nginx.conf<br>åœ¨httpæˆ–serverèŠ‚ç‚¹ä¸­æ·»åŠ ä»¥ä¸‹å†…å®¹<strong>åœ¨httpèŠ‚ç‚¹æ·»åŠ è¡¨ç¤ºå…¨å±€é…ç½®ï¼Œåœ¨serverèŠ‚ç‚¹æ·»åŠ è¡¨ç¤ºä¸ºæŒ‡å®šç½‘ç«™é…ç½®</strong>ï¼š<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">modsecurity on;\nmodsecurity_rules_file &#x2F;usr&#x2F;local&#x2F;nginx&#x2F;conf&#x2F;modsecurity&#x2F;modsecurity.conf;</code></pre></li>\n<li>ç¼–è¾‘modsecurity.conf<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">vim &#x2F;usr&#x2F;local&#x2F;nginx&#x2F;conf&#x2F;modsecurity&#x2F;modsecurity.conf\n# SecRuleEngine DetectionOnlyæ”¹ä¸ºSecRuleEngine On\n# æ·»åŠ ä¸€ä¸‹å†…å®¹\nInclude &#x2F;usr&#x2F;local&#x2F;nginx&#x2F;conf&#x2F;modsecurity&#x2F;crs-setup.conf\nInclude &#x2F;usr&#x2F;local&#x2F;nginx&#x2F;conf&#x2F;modsecurity&#x2F;rules&#x2F;*.conf</code></pre></li>\n<li>é‡æ–°åŠ è½½Nginx<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">&#x2F;usr&#x2F;local&#x2F;nginx&#x2F;sbin&#x2F;nginx -s reload</code></pre></li>\n<li>æ¨¡æ‹Ÿæ”»å‡»æµ‹è¯• <code>http://nginx.test/?param=%22%3E%3Cscript%3Ealert(1);%3C/script%3E</code><br><img src=\"http://img.moses.wang/20220609172618.png\"></li>\n</ol>\n<h1 id=\"è¿›é˜¶\"><a href=\"#è¿›é˜¶\" class=\"headerlink\" title=\"è¿›é˜¶\"></a>è¿›é˜¶</h1><h2 id=\"NginxåŸºäºIPçš„å®‰å…¨é˜²æŠ¤ç­–ç•¥\"><a href=\"#NginxåŸºäºIPçš„å®‰å…¨é˜²æŠ¤ç­–ç•¥\" class=\"headerlink\" title=\"NginxåŸºäºIPçš„å®‰å…¨é˜²æŠ¤ç­–ç•¥\"></a>NginxåŸºäºIPçš„å®‰å…¨é˜²æŠ¤ç­–ç•¥</h2><p>ç”±äºè™šæ‹Ÿæœºéƒ¨ç½²çš„Nginxï¼ŒNginxè®¿é—®æ—¥å¿—IPä¸ºè™šæ‹Ÿæœºç½‘å…³IP<code>172.16.244.1</code></p>\n<h3 id=\"Nginxè·å–çœŸå®æºIP\"><a href=\"#Nginxè·å–çœŸå®æºIP\" class=\"headerlink\" title=\"Nginxè·å–çœŸå®æºIP\"></a>Nginxè·å–çœŸå®æºIP</h3><p>todo</p>\n<h3 id=\"Nginxç¦æ­¢å›½å¤–IPæµ‹è¯•\"><a href=\"#Nginxç¦æ­¢å›½å¤–IPæµ‹è¯•\" class=\"headerlink\" title=\"Nginxç¦æ­¢å›½å¤–IPæµ‹è¯•\"></a>Nginxç¦æ­¢å›½å¤–IPæµ‹è¯•</h3><p>æŒ‚ä»£ç†è®¿é—®ä¸ç»è¿‡äº’è”ç½‘ï¼Œæ—¥å¿—åªè®°å½•è™šæ‹Ÿæœºç½‘å…³IPã€‚å±€åŸŸç½‘è®¿é—®ä¸åˆ°è™šæ‹ŸæœºIPã€‚<br><img src=\"http://img.moses.wang/20220609175952.png\"><br>TODO</p>\n<ul>\n<li><input checked=\"\" disabled=\"\" type=\"checkbox\"> é€šè¿‡colabåˆ›å»ºVPSéƒ¨ç½²Nginx âœ… 2022-06-10 ğŸ’€è¡Œä¸é€š</li>\n</ul>\n<h4 id=\"SSH-VNC\"><a href=\"#SSH-VNC\" class=\"headerlink\" title=\"SSH VNC\"></a>SSH VNC</h4><p><a href=\"https://github.com/hackingguy/Bug-Hunting-Colab/issues/31\">Failed to download https://bin.equinox.io/c/VdrWdbjqyF/cloudflared-stable-linux-amd64.tgz Â· Issue #31 Â· hackingguy/Bug-Hunting-Colab Â· GitHub</a><br><img src=\"http://img.moses.wang/20220610164944.png\"></p>\n<h4 id=\"Chrome-Remote-Desktop\"><a href=\"#Chrome-Remote-Desktop\" class=\"headerlink\" title=\"Chrome Remote Desktop\"></a>Chrome Remote Desktop</h4><p><img src=\"http://img.moses.wang/20220610165436.png\"><br><a href=\"https://research.google.com/colaboratory/faq.html#limitations-and-restrictions\">Google Colabå¸¸è§é—®é¢˜</a><br>Colab ä¸­çš„èµ„æºå°†ä¼˜å…ˆæä¾›ç»™äº¤äº’å¼ç”¨ä¾‹ã€‚æˆ‘ä»¬ç¦æ­¢å„ç§æ¶‰åŠæ‰¹é‡è®¡ç®—ã€ä¼šå¯¹ä»–äººé€ æˆè´Ÿé¢å½±å“ï¼Œæˆ–è¯•å›¾è§„é¿æˆ‘ä»¬çš„æ”¿ç­–çš„æ“ä½œã€‚Colab è¿è¡Œæ—¶ä¸­ä¸å…è®¸æ‰§è¡Œä¸‹åˆ—æ“ä½œï¼š</p>\n<ul>\n<li>æ–‡ä»¶æ‰˜ç®¡ã€åª’ä½“ä¼ é€æˆ–æä¾›å…¶ä»–ä¸ Colab çš„äº¤äº’å¼è®¡ç®—æ— å…³çš„ç½‘ç»œæœåŠ¡</li>\n<li>ä¸‹è½½ç§å­æ–‡ä»¶æˆ–è¿›è¡Œç‚¹å¯¹ç‚¹æ–‡ä»¶å…±äº«</li>\n<li>ä½¿ç”¨è¿œç¨‹æ¡Œé¢æˆ– SSH</li>\n<li>è¿æ¥åˆ°è¿œç¨‹ä»£ç†</li>\n<li>åŠ å¯†è´§å¸æŒ–çŸ¿</li>\n<li>è¿è¡Œæ‹’ç»æœåŠ¡æ”»å‡»</li>\n<li>ç ´è§£å¯†ç </li>\n<li>åˆ©ç”¨å¤šä¸ªå¸å·ç»•è¿‡è®¿é—®æƒé™æˆ–èµ„æºä½¿ç”¨æƒ…å†µé™åˆ¶</li>\n<li>åˆ›å»ºæ·±åº¦ä¼ªé€ å†…å®¹<br><img src=\"http://img.moses.wang/20220610164717.png\"></li>\n</ul>\n<p><a href=\"https://www.youtube.com/watch?v=bJUr0SnBpEM\">YouTubeå‚è€ƒè§†é¢‘</a></p>\n<h2 id=\"åˆ›å»ºDEMOåº”ç”¨\"><a href=\"#åˆ›å»ºDEMOåº”ç”¨\" class=\"headerlink\" title=\"åˆ›å»ºDEMOåº”ç”¨\"></a>åˆ›å»ºDEMOåº”ç”¨</h2><p>[[RASP-JRASP#0x06æµ‹è¯•ç”¨ä¾‹]]</p>\n","text":"äº§å“ä¿¡æ¯ç®€ä»‹ åç§° å¼€æºåè®® å¼€å‘è¯­è¨€ å¼€æºæ—¶é—´ æ´»è·ƒåº¦ ä»£ç è´¨é‡ æœ€æ–°ç‰ˆæœ¬ å‚å•† ModSecurity BSD 3-Clause License Lua 2013-12-16ï¼ˆ2.7.6ï¼‰ 5.4Kâ­ï¸ A 2022-05-31 ï¼ˆ3.1.7ï¼‰ Trustwave ModSec...","link":"","photos":[],"count_time":{"symbolsCount":"8.7k","symbolsTime":"8 mins."},"categories":[{"name":"å¼€æºWAFäº§å“é€‰å‹","slug":"å¼€æºWAFäº§å“é€‰å‹","count":7,"path":"api/categories/å¼€æºWAFäº§å“é€‰å‹.json"}],"tags":[{"name":"Nginx","slug":"Nginx","count":7,"path":"api/tags/Nginx.json"},{"name":"å¼€æºWAFäº§å“é€‰å‹","slug":"å¼€æºWAFäº§å“é€‰å‹","count":7,"path":"api/tags/å¼€æºWAFäº§å“é€‰å‹.json"},{"name":"å®‰å…¨å»ºè®¾","slug":"å®‰å…¨å»ºè®¾","count":7,"path":"api/tags/å®‰å…¨å»ºè®¾.json"},{"name":"WAF","slug":"WAF","count":6,"path":"api/tags/WAF.json"},{"name":"ModSecurity","slug":"ModSecurity","count":1,"path":"api/tags/ModSecurity.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E4%BA%A7%E5%93%81%E4%BF%A1%E6%81%AF%E7%AE%80%E4%BB%8B\"><span class=\"toc-text\">äº§å“ä¿¡æ¯ç®€ä»‹</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#ModSecurity%E4%BB%8B%E7%BB%8D\"><span class=\"toc-text\">ModSecurityä»‹ç»</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%8A%9F%E8%83%BD\"><span class=\"toc-text\">åŠŸèƒ½</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#ModSecurity%E5%8A%9F%E8%83%BD\"><span class=\"toc-text\">ModSecurityåŠŸèƒ½</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%87%86%E5%A4%87%E7%8E%AF%E5%A2%83\"><span class=\"toc-text\">å‡†å¤‡ç¯å¢ƒ</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%AE%89%E8%A3%85\"><span class=\"toc-text\">å®‰è£…</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E4%BE%9D%E8%B5%96\"><span class=\"toc-text\">æ“ä½œç³»ç»Ÿä¾èµ–</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%AE%89%E8%A3%85ModSecurity\"><span class=\"toc-text\">å®‰è£…ModSecurity</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%AE%89%E8%A3%85Nginx%E4%B8%8EModSecurity-nginx\"><span class=\"toc-text\">å®‰è£…Nginxä¸ModSecurity-nginx</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E9%AA%8C%E8%AF%81\"><span class=\"toc-text\">éªŒè¯</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E9%85%8D%E7%BD%AE\"><span class=\"toc-text\">é…ç½®</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E8%BF%9B%E9%98%B6\"><span class=\"toc-text\">è¿›é˜¶</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Nginx%E5%9F%BA%E4%BA%8EIP%E7%9A%84%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4%E7%AD%96%E7%95%A5\"><span class=\"toc-text\">NginxåŸºäºIPçš„å®‰å…¨é˜²æŠ¤ç­–ç•¥</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Nginx%E8%8E%B7%E5%8F%96%E7%9C%9F%E5%AE%9E%E6%BA%90IP\"><span class=\"toc-text\">Nginxè·å–çœŸå®æºIP</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Nginx%E7%A6%81%E6%AD%A2%E5%9B%BD%E5%A4%96IP%E6%B5%8B%E8%AF%95\"><span class=\"toc-text\">Nginxç¦æ­¢å›½å¤–IPæµ‹è¯•</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#SSH-VNC\"><span class=\"toc-text\">SSH VNC</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#Chrome-Remote-Desktop\"><span class=\"toc-text\">Chrome Remote Desktop</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%88%9B%E5%BB%BADEMO%E5%BA%94%E7%94%A8\"><span class=\"toc-text\">åˆ›å»ºDEMOåº”ç”¨</span></a></li></ol></li></ol>","author":{"name":"Moses","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"ä¸€ä½æ­£åœ¨é‡å¡‘çŸ¥è¯†çš„æŠ€æœ¯äºº","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"å¼€æºWAFè°ƒç ”ä¹‹äº§å“é€‰å‹-Nginxä¸´æ—¶åº”æ€¥å·¥å…·","uid":"ca8ec5f39f069a5397c4e6f4f192ade4","slug":"Nginx-log-checkæ£€æµ‹å·¥å…·","date":"2022-06-15T14:30:16.000Z","updated":"2022-10-26T10:01:41.029Z","comments":true,"path":"api/articles/Nginx-log-checkæ£€æµ‹å·¥å…·.json","keywords":null,"cover":"https://gtwallpaper.org/sites/default/files/wallpaper/159445/a-tunnel-8k-secret-passage-wallpapers-159445-3841-2646948.png","text":"å·¥å…·ä»‹ç»æ­¤è„šæœ¬æ˜¯å‚è€ƒnmgxy&#x2F;klionsecä¿®æ”¹è€Œæ¥,é‡æ–°æ·»åŠ äº†ä¸€äº›ç‰¹å¾ï¼Œåªç”¨æ¥ä¸´æ—¶æ•‘æ€¥ï¼Œè¿˜æ˜¯æ¨èåˆ°ELKæˆ–è€…Splunkä¸­åˆ†æğŸ©é¡¹ç›®åœ°å€GitHub - al0ne&#x2F;nginx_log_check: Nginxæ—¥å¿—å®‰å…¨åˆ†æè„šæœ¬ åŠŸèƒ½ ç»Ÿè®¡Top 20 åœ°...","link":"","photos":[],"count_time":{"symbolsCount":"11k","symbolsTime":"10 mins."},"categories":[{"name":"å¼€æºWAFäº§å“é€‰å‹","slug":"å¼€æºWAFäº§å“é€‰å‹","count":7,"path":"api/categories/å¼€æºWAFäº§å“é€‰å‹.json"}],"tags":[{"name":"åº”æ€¥å“åº”","slug":"åº”æ€¥å“åº”","count":1,"path":"api/tags/åº”æ€¥å“åº”.json"},{"name":"Nginx","slug":"Nginx","count":7,"path":"api/tags/Nginx.json"},{"name":"å¼€æºWAFäº§å“é€‰å‹","slug":"å¼€æºWAFäº§å“é€‰å‹","count":7,"path":"api/tags/å¼€æºWAFäº§å“é€‰å‹.json"},{"name":"æ—¥å¿—åˆ†æ","slug":"æ—¥å¿—åˆ†æ","count":1,"path":"api/tags/æ—¥å¿—åˆ†æ.json"},{"name":"å®‰å…¨å»ºè®¾","slug":"å®‰å…¨å»ºè®¾","count":7,"path":"api/tags/å®‰å…¨å»ºè®¾.json"}],"author":{"name":"Moses","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"ä¸€ä½æ­£åœ¨é‡å¡‘çŸ¥è¯†çš„æŠ€æœ¯äºº","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"å¼€æºWAFè°ƒç ”ä¹‹äº§å“é€‰å‹-Janusec","uid":"46d38e362d8b157bea9e251631b6d0f7","slug":"å¼€æºWAFé€‰å‹-Janusec","date":"2022-06-08T05:58:01.418Z","updated":"2022-10-26T10:09:28.083Z","comments":true,"path":"api/articles/å¼€æºWAFé€‰å‹-Janusec.json","keywords":null,"cover":"https://gtwallpaper.org/sites/default/files/wallpaper/159446/abrams-falls-wallpapers-159446-1807-7416337.png","text":"äº§å“ä¿¡æ¯ç®€ä»‹ åç§° å¼€æºåè®® å¼€å‘è¯­è¨€ å¼€æºæ—¶é—´ æ´»è·ƒåº¦ ä»£ç è´¨é‡ æœ€æ–°ç‰ˆæœ¬ å‚å•† Janusec GNU AGPLv3 Go 2021-04-5ï¼ˆ1.0.0ï¼‰ 923â­ï¸ 2022-04-03 ï¼ˆ1.2.9ï¼‰ ä¸ªäººå¼€å‘è€… äº§å“æè¿°Janusecåº”ç”¨ç½‘å…³ï¼Œä¸€ç§é€‚ç”¨äºå„ç§åœºæ™¯ï¼ˆå…¬æœ‰äº‘...","link":"","photos":[],"count_time":{"symbolsCount":"5.8k","symbolsTime":"5 mins."},"categories":[{"name":"å¼€æºWAFäº§å“é€‰å‹","slug":"å¼€æºWAFäº§å“é€‰å‹","count":7,"path":"api/categories/å¼€æºWAFäº§å“é€‰å‹.json"}],"tags":[{"name":"Nginx","slug":"Nginx","count":7,"path":"api/tags/Nginx.json"},{"name":"å¼€æºWAFäº§å“é€‰å‹","slug":"å¼€æºWAFäº§å“é€‰å‹","count":7,"path":"api/tags/å¼€æºWAFäº§å“é€‰å‹.json"},{"name":"å®‰å…¨å»ºè®¾","slug":"å®‰å…¨å»ºè®¾","count":7,"path":"api/tags/å®‰å…¨å»ºè®¾.json"},{"name":"WAF","slug":"WAF","count":6,"path":"api/tags/WAF.json"},{"name":"Kongç½‘å…³","slug":"Kongç½‘å…³","count":1,"path":"api/tags/Kongç½‘å…³.json"}],"author":{"name":"Moses","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"ä¸€ä½æ­£åœ¨é‡å¡‘çŸ¥è¯†çš„æŠ€æœ¯äºº","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}