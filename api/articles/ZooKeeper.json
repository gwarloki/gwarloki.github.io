{"title":"分布式系统学习-Zookeeper","uid":"618a44db788d8cdf326efbd9f5f8d4cf","slug":"ZooKeeper","date":"2022-02-15T00:57:00.000Z","updated":"2022-10-27T05:33:15.842Z","comments":true,"path":"api/articles/ZooKeeper.json","keywords":null,"cover":"https://gtwallpaper.org/sites/default/files/wallpaper/159416/4k-beneath-the-clouds-wallpapers-159416-910411-8858546.png","content":"<p>Zookeeper在 [[CAP]]中选择了C和P，在Leader故障，选举新的Leader期间，zookeeper集群不对外提供服务。</p>\n<h2 id=\"特点\"><a href=\"#特点\" class=\"headerlink\" title=\"特点\"></a>特点</h2><ul>\n<li>分布式协调</li>\n<li>可靠性<ul>\n<li>有集群不可用的时候，即leader下线，follower在选举的期间，集群不可用。<br> 一致性</li>\n<li>最终一致性</li>\n<li>一致性协议 [[ZAB]]</li>\n</ul>\n</li>\n<li>时序</li>\n</ul>\n<h2 id=\"扩展\"><a href=\"#扩展\" class=\"headerlink\" title=\"扩展\"></a>扩展</h2><h3 id=\"架构\"><a href=\"#架构\" class=\"headerlink\" title=\"架构\"></a>架构</h3><h4 id=\"角色\"><a href=\"#角色\" class=\"headerlink\" title=\"角色\"></a>角色</h4><ul>\n<li>leader<ul>\n<li>支持写，支持读</li>\n</ul>\n</li>\n<li>follower<ul>\n<li>支持读，参与选举</li>\n<li>10个人选举和10亿人选举，自然是10人选举的速度快，所以follower的数量保证选举即可，无需过多的数量。</li>\n</ul>\n</li>\n<li>observer<br>  支持读，扩展查询的性能。</li>\n</ul>\n<h4 id=\"角色在zk配置文件中的体现-zoo-cfg\"><a href=\"#角色在zk配置文件中的体现-zoo-cfg\" class=\"headerlink\" title=\"角色在zk配置文件中的体现 zoo.cfg\"></a>角色在zk配置文件中的体现 zoo.cfg</h4><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">server.1&#x3D;node-001:2888:3888\nserver.2&#x3D;node-001:2888:3888\nerver.3&#x3D;node-001:2888:3888\nserver.4&#x3D;node-001:2888:3888:observer\nserver.5&#x3D;node-001:2888:3888:observer\nserver.6&#x3D;node-001:2888:3888:observer\nserver.7&#x3D;node-001:2888:3888:observer</code></pre>\n<h2 id=\"快速\"><a href=\"#快速\" class=\"headerlink\" title=\"快速\"></a>快速</h2><ul>\n<li>正常情况下的读写速度快</li>\n<li>当leader掉线，选举新的leader速度快，集群恢复速度快。</li>\n</ul>\n<h2 id=\"数据存储\"><a href=\"#数据存储\" class=\"headerlink\" title=\"数据存储\"></a>数据存储</h2><ul>\n<li>在内存中存数据的状态。状态数据必定是在日志数据写入成功之后，才有可能生成。</li>\n<li>在磁盘中写日志。当然，日志也是先写到内存，再到磁盘，内存中的状态数据和日志数据是两类数据。</li>\n</ul>\n<h2 id=\"Server\"><a href=\"#Server\" class=\"headerlink\" title=\"Server\"></a>Server</h2><h2 id=\"Client\"><a href=\"#Client\" class=\"headerlink\" title=\"Client\"></a>Client</h2><ul>\n<li>watch<ul>\n<li>new zk 时传入的watch<ul>\n<li>是session级别，跟path，node没有关系。</li>\n<li>session状态发生变化，会被重复触发。</li>\n<li>当与连接的服务器中断连接，自动重连后，sessionId不发生变化。</li>\n</ul>\n</li>\n<li>普通的watch<ul>\n<li>一次性，不会重复被触发，要想重复触发，每次触发后，要再watch。</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"响应式编程\"><a href=\"#响应式编程\" class=\"headerlink\" title=\"响应式编程\"></a>响应式编程</h2><p><strong>与常规编程的主要差异：工程师由业务执行逻辑顺序的规划者，编程业务内容的规划者，执行顺序交给计算机来调度。</strong></p>\n<h2 id=\"应用场景\"><a href=\"#应用场景\" class=\"headerlink\" title=\"应用场景\"></a>应用场景</h2><ul>\n<li>分布式配置，服务注册发现</li>\n<li>分布式锁</li>\n<li>分布式协调</li>\n</ul>\n","text":"Zookeeper在 [[CAP]]中选择了C和P，在Leader故障，选举新的Leader期间，zookeeper集群不对外提供服务。 特点 分布式协调 可靠性 有集群不可用的时候，即leader下线，follower在选举的期间，集群不可用。 一致性 最终一致性 一致性协议 ...","link":"","photos":[],"count_time":{"symbolsCount":962,"symbolsTime":"1 mins."},"categories":[{"name":"分布式","slug":"分布式","count":6,"path":"api/categories/分布式.json"}],"tags":[{"name":"分布式系统","slug":"分布式系统","count":3,"path":"api/tags/分布式系统.json"},{"name":"分布式理论","slug":"分布式理论","count":1,"path":"api/tags/分布式理论.json"},{"name":"CAP","slug":"CAP","count":1,"path":"api/tags/CAP.json"},{"name":"Zookeeper","slug":"Zookeeper","count":1,"path":"api/tags/Zookeeper.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E7%89%B9%E7%82%B9\"><span class=\"toc-text\">特点</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%89%A9%E5%B1%95\"><span class=\"toc-text\">扩展</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%9E%B6%E6%9E%84\"><span class=\"toc-text\">架构</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E8%A7%92%E8%89%B2\"><span class=\"toc-text\">角色</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E8%A7%92%E8%89%B2%E5%9C%A8zk%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E4%BD%93%E7%8E%B0-zoo-cfg\"><span class=\"toc-text\">角色在zk配置文件中的体现 zoo.cfg</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%BF%AB%E9%80%9F\"><span class=\"toc-text\">快速</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8\"><span class=\"toc-text\">数据存储</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Server\"><span class=\"toc-text\">Server</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Client\"><span class=\"toc-text\">Client</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%93%8D%E5%BA%94%E5%BC%8F%E7%BC%96%E7%A8%8B\"><span class=\"toc-text\">响应式编程</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF\"><span class=\"toc-text\">应用场景</span></a></li></ol>","author":{"name":"Moses","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"一位正在重塑知识的技术人","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"容器安全平台-小佑科技","uid":"af03dd5b5c07726870f53848ba50413b","slug":"容器安全平台-小佑科技","date":"2022-03-04T09:35:44.000Z","updated":"2022-10-27T02:15:54.248Z","comments":true,"path":"api/articles/容器安全平台-小佑科技.json","keywords":null,"cover":"https://gtwallpaper.org/sites/default/files/wallpaper/159413/4k-aurora-wallpapers-159413-3333-6138359.png","text":"install 修改k8s-dosec-web.yaml和k8s-dosec-configMap.yamlenv: - name:Web_API_ADDR value: &#39;http:&#x2F;&#x2F;masterip:30089&#39; #configmap #注...","link":"","photos":[],"count_time":{"symbolsCount":571,"symbolsTime":"1 mins."},"categories":[{"name":"Cloud-Native-Security","slug":"Cloud-Native-Security","count":12,"path":"api/categories/Cloud-Native-Security.json"}],"tags":[{"name":"云原生安全","slug":"云原生安全","count":6,"path":"api/tags/云原生安全.json"},{"name":"容器安全平台","slug":"容器安全平台","count":5,"path":"api/tags/容器安全平台.json"},{"name":"产品选型","slug":"产品选型","count":6,"path":"api/tags/产品选型.json"},{"name":"小佑科技","slug":"小佑科技","count":1,"path":"api/tags/小佑科技.json"}],"author":{"name":"Moses","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"一位正在重塑知识的技术人","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"DevSecOps工具链","uid":"1a872c8e58dbc5f12955fd570dcb5da9","slug":"Devsecops工具链","date":"2022-02-08T02:58:04.000Z","updated":"2022-10-27T02:45:24.231Z","comments":true,"path":"api/articles/Devsecops工具链.json","keywords":null,"cover":"https://gtwallpaper.org/sites/default/files/wallpaper/159416/4k-beneath-the-clouds-wallpapers-159416-909668-1806574.png","text":"DevSecOps实践Gartner在2019年的一篇文章中给出了一个经过调研和分析的比较全面的实践清单。如图它由一些列关键路径和持续步骤中的措施和机制组成，周而复始第运转。它的关注点主要是在研发过程中的安全漏洞及其引发的各类风险的管控。 忘记了😄 某证券公司DevSecOps落...","link":"","photos":[],"count_time":{"symbolsCount":"8.3k","symbolsTime":"8 mins."},"categories":[{"name":"DevSecOps","slug":"DevSecOps","count":3,"path":"api/categories/DevSecOps.json"}],"tags":[{"name":"DevSecOps工具链","slug":"DevSecOps工具链","count":1,"path":"api/tags/DevSecOps工具链.json"},{"name":"CI/CD","slug":"CI-CD","count":4,"path":"api/tags/CI-CD.json"},{"name":"工具链风险","slug":"工具链风险","count":1,"path":"api/tags/工具链风险.json"}],"author":{"name":"Moses","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"一位正在重塑知识的技术人","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}