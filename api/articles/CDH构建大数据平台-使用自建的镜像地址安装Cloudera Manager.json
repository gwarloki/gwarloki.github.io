{"title":"CDH构建大数据平台-使用自建的镜像地址安装Cloudera Manager","uid":"1a2332bedd5393f913279007dced6f6f","slug":"CDH构建大数据平台-使用自建的镜像地址安装Cloudera Manager","date":"2020-10-23T04:53:03.000Z","updated":"2022-10-27T01:30:34.940Z","comments":true,"path":"api/articles/CDH构建大数据平台-使用自建的镜像地址安装Cloudera Manager.json","keywords":null,"cover":"https://gtwallpaper.org/sites/default/files/wallpaper/159445/a-tunnel-8k-secret-passage-wallpapers-159445-3971-9863971.png","content":"<p>CDH构建大数据平台-使用自建的镜像地址安装Cloudera Manager</p>\n<h1 id=\"一、简介\"><a href=\"#一、简介\" class=\"headerlink\" title=\"一、简介\"></a>一、简介</h1><p>目前Hadoop发行版非常多，有华为发行版、Intel发行版、Cloudera发行版(CDH)、Hortonworks版本（HDP）等，所有这些发行版均是基于Apache Hadoop衍生出来的，之所以有这么多的版本，完全是由Apache Hadoop的开源协议决定的：任何人可以对其进行修改，并作为开源或商业产品发布&#x2F;销售。<br>CDH (Cloudera’s Distribution, including Apache Hadoop)，是Hadoop众多分支中的一种，由Cloudera维护，基于稳定版本的Apache Hadoop构建，并集成了很多补丁，可直接用于生产环境。   </p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>从2021年1月31日开始，所有Cloudera软件都需要有效的订阅，并且只能通过付费墙进行访问。即目前Apache社区版本外均采用商业付费模式。但社区版在版本管理、部署运维、生态即安全方面还有很多不足之处，故本文意在通过自建镜像方式部署CDH版本Hadoop</p></blockquote>\n<h2 id=\"1-环境准备\"><a href=\"#1-环境准备\" class=\"headerlink\" title=\"1.环境准备\"></a>1.环境准备</h2><h3 id=\"1-1主机资源准备\"><a href=\"#1-1主机资源准备\" class=\"headerlink\" title=\"1.1主机资源准备\"></a>1.1主机资源准备</h3><pre class=\"line-numbers language-markdown\" data-language=\"markdown\"><code class=\"language-markdown\">测试环境采用Mac本地部署虚拟机方式安装3台centos7基础web服务器。 \n最小配置为： \n- Hadoop01（CM-server|Agent）内存最小4G推荐12-16G；\n- Hadoop02（Agent）内存最小4G推荐8-16G；  \n- Hadoop03（Agent）内存最小4G推荐8-16G；</code></pre>\n<h3 id=\"1-2系统环境准备\"><a href=\"#1-2系统环境准备\" class=\"headerlink\" title=\"1.2系统环境准备\"></a>1.2系统环境准备</h3><ul>\n<li>网络配置：所有节点使用静态IP</li>\n<li>主机名：修改所有节点主机名并加入到hosts文件</li>\n<li>防火墙关闭：systemctl stop firewalld &amp;&amp; systemctl disable firewalld </li>\n<li>selinux关闭：sed -i ‘s&#x2F;^SELINUX&#x3D;.&#x2F;SELINUX&#x3D;disabled&#x2F;‘ &#x2F;etc&#x2F;selinux&#x2F;config &amp;&amp; setenforce 0 </li>\n<li>NTP时间同步：虚拟机可选择相同时区即可，生产环境配置局区域内NTP    </li>\n<li>SSH免密登录：所有节点分别执行ssh-keygen -t rsa、ssh-copy-id -i &#x2F;root&#x2F;.ssh&#x2F;id_rsa.pub root@hadoop[01-03]</li>\n<li>设置文件打开数据和用户最大进程数：通过修改limits.conf进行优化</li>\n</ul>\n<h3 id=\"1-3安装包与依赖\"><a href=\"#1-3安装包与依赖\" class=\"headerlink\" title=\"1.3安装包与依赖\"></a>1.3安装包与依赖</h3><p>所有节点安装：yum -y install chkconfig python bind-utils psmisc libxslt zlib sqlite cyrus-sasl-plain cyrus-sasl-gssapi fuse fuse-libs redhat-lsb postgresql portmap mod_ssl openssl-devel python-psycopg2 MySQL-python</p>\n<h2 id=\"2-搭建私仓\"><a href=\"#2-搭建私仓\" class=\"headerlink\" title=\"2.搭建私仓\"></a>2.搭建私仓</h2><p>cm-server或者任意一台同局域网同网段内服务安装web服务并启动，<code>yum -y install httpd &amp;&amp; systemctl start httpd</code>;<br>下载对应的CM资源到web目录，下载地址：<a href=\"http://ro-bucharest-repo.bigstepcloud.com/cloudera-repos/\">http://ro-bucharest-repo.bigstepcloud.com/cloudera-repos/</a><br>创建repodata数据文件，<code>yum -y install createrepo &amp;&amp; cd /var/www/html/cm-6.2.0/ &amp;&amp; createrepo .</code><br>创建本地yum文件cloudra-manager.repo，并将文件放置在私仓web目录。</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"># Packages for Cloudera Manager, Version 5, on RedHat or CentOS 7 x86_64                  \nname&#x3D;Cloudera Manager\nbaseurl&#x3D;http:&#x2F;&#x2F;172.16.3.109&#x2F;cm-6.2.0&#x2F;\ngpgkey &#x3D;http:&#x2F;&#x2F;172.16.3.109&#x2F;cm-6.2.0&#x2F;RPM-GPG-KEY-cloudera    \nenabled &#x3D; 1\ngpgcheck &#x3D; 0</code></pre>\n<p>配置集群本地yum源，<code>mkdir /etc/yum.repos.d/repo-backup &amp;&amp; mv /etc/yum.repos.d/*.rpo repo-backup</code></p>\n<h1 id=\"部署CM-server\"><a href=\"#部署CM-server\" class=\"headerlink\" title=\"部署CM-server\"></a>部署CM-server</h1><p>1&gt;安装MySQL数据库，测试单台5.6正式可使用主从5.7<br>MySQL5.6.51安装指导详见<a href=\"https://blog.csdn.net/yy8623977/article/details/118090371\">https://blog.csdn.net/yy8623977/article/details/118090371</a><br>2&gt;配置元数据库详见<a href=\"https://www.cnblogs.com/yinzhengjie/articles/10384065.html\">https://www.cnblogs.com/yinzhengjie/articles/10384065.html</a><br>3&gt;配置CM</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">sed -i s&#39;[[Xmx2G]][[Xmx4G]]#&#39; &#x2F;etc&#x2F;default&#x2F;cloudera-scm-server &amp;&amp; grep CMF_JAVA_OPTS &#x2F;etc&#x2F;default&#x2F;cloudera-scm-server \nexport CMF_JAVA_OPTS&#x3D;&quot;-Xmx4G -XX:MaxPermSize&#x3D;256m -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath&#x3D;&#x2F;tmp&quot; </code></pre>\n<p>4&gt;初始化数据库,<code>/opt/cloudera/cm/schema/scm_prepare_database.sh mysql scm scm moses &amp;&amp; systemctl start cloudera-scm-server</code></p>\n<h1 id=\"部署CM-Agent\"><a href=\"#部署CM-Agent\" class=\"headerlink\" title=\"部署CM-Agent\"></a>部署CM-Agent</h1><p>节点安装依赖包，更换本地yum源安装CM-Agent，配置config.ini文件的CM地址。</p>\n<p>HDFS服务安装时报错：su - hdfs &amp;&amp; hdfs dfsadmin -safemode leave</p>\n","text":"CDH构建大数据平台-使用自建的镜像地址安装Cloudera Manager 一、简介目前Hadoop发行版非常多，有华为发行版、Intel发行版、Cloudera发行版(CDH)、Hortonworks版本（HDP）等，所有这些发行版均是基于Apache Hadoop衍生出来的...","link":"","photos":[],"count_time":{"symbolsCount":"2.8k","symbolsTime":"3 mins."},"categories":[{"name":"大数据","slug":"大数据","count":3,"path":"api/categories/大数据.json"}],"tags":[{"name":"Hadoop","slug":"Hadoop","count":2,"path":"api/tags/Hadoop.json"},{"name":"Cloudera","slug":"Cloudera","count":2,"path":"api/tags/Cloudera.json"},{"name":"大数据","slug":"大数据","count":3,"path":"api/tags/大数据.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E4%B8%80%E3%80%81%E7%AE%80%E4%BB%8B\"><span class=\"toc-text\">一、简介</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#1-%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87\"><span class=\"toc-text\">1.环境准备</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-1%E4%B8%BB%E6%9C%BA%E8%B5%84%E6%BA%90%E5%87%86%E5%A4%87\"><span class=\"toc-text\">1.1主机资源准备</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-2%E7%B3%BB%E7%BB%9F%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87\"><span class=\"toc-text\">1.2系统环境准备</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-3%E5%AE%89%E8%A3%85%E5%8C%85%E4%B8%8E%E4%BE%9D%E8%B5%96\"><span class=\"toc-text\">1.3安装包与依赖</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#2-%E6%90%AD%E5%BB%BA%E7%A7%81%E4%BB%93\"><span class=\"toc-text\">2.搭建私仓</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E9%83%A8%E7%BD%B2CM-server\"><span class=\"toc-text\">部署CM-server</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E9%83%A8%E7%BD%B2CM-Agent\"><span class=\"toc-text\">部署CM-Agent</span></a></li></ol>","author":{"name":"Moses","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"一位正在重塑知识的技术人","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"容器安全平台-Habor-Scanner","uid":"4a5feac766d456074a0922c23a83b4df","slug":"容器镜像安全-Habor-scanner","date":"2021-04-05T18:16:02.000Z","updated":"2022-10-27T02:15:23.452Z","comments":true,"path":"api/articles/容器镜像安全-Habor-scanner.json","keywords":null,"cover":"https://gtwallpaper.org/sites/default/files/wallpaper/159413/4k-aurora-wallpapers-159413-3526-9533250.png","text":"Harbor-Scanner一个免费的镜像漏洞扫描工具, 可以扫描镜像中已安装软件包的漏洞，支持中文漏洞库，可与 Harbor 无缝集成。 Dosec 的商业客户可以使用企业版扫描功能，例如扫描开源框架中的漏洞以及扫描容器镜像中包含的敏感数据。同时企业版增加了WEB UI, 提供...","link":"","photos":[],"count_time":{"symbolsCount":"2.4k","symbolsTime":"2 mins."},"categories":[{"name":"Cloud-Native-Security","slug":"Cloud-Native-Security","count":12,"path":"api/categories/Cloud-Native-Security.json"}],"tags":[{"name":"镜像安全","slug":"镜像安全","count":3,"path":"api/tags/镜像安全.json"},{"name":"云原生安全","slug":"云原生安全","count":6,"path":"api/tags/云原生安全.json"},{"name":"容器安全平台","slug":"容器安全平台","count":5,"path":"api/tags/容器安全平台.json"},{"name":"产品选型","slug":"产品选型","count":6,"path":"api/tags/产品选型.json"},{"name":"harbor","slug":"harbor","count":1,"path":"api/tags/harbor.json"}],"author":{"name":"Moses","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"一位正在重塑知识的技术人","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"手动安装CDH6.1","uid":"6b3a3497e1eeebd4a65d0ba4c26e41db","slug":"手动安装CDH6.1.md","date":"2020-10-20T09:53:00.000Z","updated":"2022-10-27T01:28:20.806Z","comments":true,"path":"api/articles/手动安装CDH6.1.md.json","keywords":null,"cover":"https://gtwallpaper.org/sites/default/files/wallpaper/159445/a-tunnel-8k-secret-passage-wallpapers-159445-3964-1849347.png","text":"手工安装仓库# 官方Parcels仓库： # https:&#x2F;&#x2F;archive.cloudera.com&#x2F;cdh6&#x2F;6.1.0&#x2F;parcels&#x2F; # # Cloudera-Manger仓库： # https:&#x2F;&...","link":"","photos":[],"count_time":{"symbolsCount":"2.2k","symbolsTime":"2 mins."},"categories":[{"name":"大数据","slug":"大数据","count":3,"path":"api/categories/大数据.json"}],"tags":[{"name":"Hadoop","slug":"Hadoop","count":2,"path":"api/tags/Hadoop.json"},{"name":"Cloudera","slug":"Cloudera","count":2,"path":"api/tags/Cloudera.json"},{"name":"大数据","slug":"大数据","count":3,"path":"api/tags/大数据.json"}],"author":{"name":"Moses","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"一位正在重塑知识的技术人","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}